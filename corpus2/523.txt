I'd like to add an extension to a filename before the file extension, otherwise leaving the given filename the same. In particular, absolute filenames should stay absolute, and relative filenames should stay relative. Examples: suppose the piece I want to insert is `".123"`, then   * `/home/me/dir/foo.txt` becomes `/home/me/dir/foo.123.txt`.   * `xyz.csv` becomes `xyz.123.csv`   * `foobar` becomes `foobar.123` (just append in case of no extension) I don't expect to be dealing with filenames that already have multiple extensions, but just in case, the desired behavior is   * `nomnom.tar.gz` becomes `nomnom.123.tar.gz` I can ensure that the filename does not end with a slash. The obvious way to do this is by concatenating the directory name, the file base name, the new piece, and the extension:               insertPiece[fn_, piece_] := FileNameJoin[{           DirectoryName[fn],           StringJoin[{FileBaseName[fn], piece, ".", FileExtension[fn]}]     }]      but is there some corner case I missed in which this wouldn't work? Is there a more efficient or more elegant way to do it?