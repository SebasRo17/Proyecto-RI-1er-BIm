I would to write a density matrix "matr" related to a quantum system in a mixed state. "Ham" is the Hamiltonian of N-spin system. The code I wrote is:               {evl, eve} = Quiet[Eigensystem[Ham]];     ord = Ordering[evl];     evl = evl[[ord]];     eve = eve[[ord]];     matr = ConstantArray[0, {2^(Nspin/2), 2^(Nspin/2)}];     Monitor[Do[re = matrix[eve[[1]], a2, a1, Nspin];       matr[[a2, a1]] = re; matr[[a1, a2]] = re, {a1, 1, 2^(Nspin/2)}, {a2,         1, a1}], {a1, a2}]      The time needed to solve the problem for a large number of Nspin it's quite long. I woul like to know if is possible to modify the code in order to make the process faster.