I am trying to implement a Poincare section for a gravitational movement on the plane $(x,y)$. Here is the code I wrote               PoincareSection[cix_, civx_, ciy_, civy_]:=         q = 0.9;         Rc = 0.14;         v0 = 1;         Φ[x_, y_] := 1/2 v0^2 Log[Rc^2 + x^2 + (y/q)^2];         h1 = x'[t] == vx[t];         h2 = vx'[t] == -D[Φ[x, y], x] /. x -> x[t] /. y -> y[t];         h3 = y'[t] == vy[t];         h4 = vy'[t] == - D[Φ[x, y], y] /. x -> x[t] /. y -> y[t];         Return[Reap[NDSolve[{h1, h2, h3, h4,         x[0] == cix, vx[0] == civx, y[0] == ciy, vy[0] == civy,         WhenEvent[{y[t] == 0, vy[t] > 0}, Sow[{x[t], vx[t]}]]},         {x[t], vx[t], y[t], vy[t]},         {t, 0, 100}]][[2]]];      However, when I try to run this code, I always get the following error: > NDSolve::ndinnt: Initial condition civx is not a number or a rectangular > array of numbers. I have tried using `N` and pattern `_?NumericQ` for the parameters of the function, but that didn't work out... Any ideas what may be causing the problem ? (If you see any other improvements I could make to my code I would be happy to hear them...)