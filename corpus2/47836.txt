I would like to know how to generate all rooted trees on $n$ vertices using Mathematica? More precisely, I am interested in generating algebraic expressions equivalent to rooted trees and constructed as follows:   * Let $U$ be some function of one variable $x$.    * All expressions are obtained using exclusively composition by $U$ or multiplication by $U$   * Multiplication by $U$ correspond to adding a child to a vertex.   * Composition by $U$ corresponds to adding a parent. Clarifying examples:   * $U\big[U[x] U[x]\big]$ is equivalent to the rooted tree: > ![enter image description here](http://i.stack.imgur.com/VlIJv.jpg)   * While $U[x]U\big[U[x] U[x]\big]$ is equivalent to the rooted tree > ![tree1](http://i.stack.imgur.com/LDLUV.jpg)   * And finally $U\Big[U[x]\,U\big[U[x] U[x]\big]\Big]$ is equivalent to the rooted tree > ![tree2](http://i.stack.imgur.com/gB8FQ.jpg) Could you please help me generate all rooted trees on $n$ vertices, i.e. algebraic expressions as above with $U$ appearing $n$ times?