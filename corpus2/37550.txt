We have that a density matrix can be written in a basis of spherical tensors: $\rho =\sum _{K=0}^S\sum_{q=-K}^K \rho _{\text{Kq}}^{(S)} T_{\text{Kq}}^{(S)}$ for example for a 3x3 matrix, $S=1$, dimension of the matrix is $2S+1$, I will drop superscript (S) for simplicity $\rho =\rho_{00}T_{00}+\rho_{1-1}T_{1-1}+\rho_{10}T_{10}+\rho_{11}T_{11}+\rho_{2-2}T_{2-2}+\rho_{2-1}T_{2-1}+\rho_{20}T_{20}+\rho_{21}T_{21}+\rho_{21}T_{21}$ Now, I have a command that gives me the matrix representation of $T_{Kq}^{(S)}$ I want to know now how to make a program so that if you give as an imput the parameter S, they write you the resultant matrix dependent of the coefficients $\rho_{Kq}$. Also as $\rho_{Kq}=(-1)^q\rho_{Kq}^*$, this should also be implemented so that the final matrix depends on fewer parameters. **Edit:** Answering to Hector below. I have not programmed the command which gives $T_{Kq}^{(S)}$, to say the truth I have not made code in Mathematica never, and hardly ever elsewhere. Well command is sphtens[K,q,S] I've been thinking about the algorithm to get the desired result. To me the step are the following:   * Input the value of S   * Create a square matrix of zeros of dimension 2S+1. Call it $\rho$ for example.   * Create two loops one for the K and another one for the q for $K=0$ till $2S$ for $q=-K$ till $K$ if $q\geq 0$ $\rho=\rho + \rho_{Kq}$ \times sphtens[K,q,S] if not $\rho=\rho + (-1)^q\rho_{Kq}^* \times$ sphtens[K,q,S] end for end for Basically what I don't know is to write this in Wolfram language