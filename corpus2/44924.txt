I would like to find the connected(with periodic boundary conditions) components in a large binary matrix. What I've tried, and it does a fair job is:               MorphologicalComponents[RandomInteger[{0, 1}, {100, 100}],CornerNeighbors -> False]      For instance:               ArrayPlot[MorphologicalComponents[RandomInteger[{0, 1}, {20, 20}], CornerNeighbors -> False], ColorFunction -> "Rainbow", ImageSize -> Large]      ![enter image description here](http://i.stack.imgur.com/edcNT.png) The only option missing here is the periodic boundary condition. `MorphologicalComponents` doesn't have a `DistanceFunction` to impose periodic boundary conditions there. The other idea I had was to give up on `MorphologicalComponents` and use `ClusteringComponents` with a complicated `DistanceFunction`, but that is just a pain in the neck. * * * ## Example: Let me give an example of what I mean by periodic boundary condition. For instance given the input:               {{1, 0, 0, 1, 1}, {0, 0, 1, 0, 0}, {1, 1, 1, 0, 1}, {0, 1, 0, 0, 0}, {1, 0, 0, 1, 0}}      I would expect to get something like:               {{1, 0, 0, 1, 1}, {0, 0, 2, 0, 0}, {2, 2, 2, 0, 2}, {0, 2, 0, 0, 0}, {1, 0, 0, 1, 0}}      As an output. The arrayplots for these two matrices are: ![enter image description here](http://i.stack.imgur.com/0Xmpq.png) ![enter image description here](http://i.stack.imgur.com/zc5Wj.png)