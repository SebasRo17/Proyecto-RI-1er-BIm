I am a new user to _Mathematica_ and I have been trying to figure out how to find $\Theta(\omega)$ from my 'experimental' values of energy and $\ln(\sqrt{R(\omega)})$ (I am just running a simulation, letting $R$ to be a Lorentizan curve and energy be $0\,\text{eV}$--$10\,\text{eV}$, with $0.001$ interval). The following are the equations I used: $$ \ln(r(\omega)) = \ln\left(\sqrt{R(\omega)}\right) + \mathrm{i}\,\Theta(\omega) $$ and by KK relation, $$ \Theta(\omega) = -\frac{\omega}{\pi} \int_{0}^{\infty}\frac{\ln\left(\sqrt{R(x)}\right) - \ln\left(\sqrt{R(Ï‰)}\right)}{x^2-\omega^2}\,\mathrm{d}x, $$ These equations can be found from this website: http://dept.phy.bme.hu/education/optical_spectroscopy/lecture2_rev.pdf (pg5) and the physical meaning of $R$ is the reflectivity, and $\Theta(\omega)$ is the phase difference between $R$ and $r$, the reflection coeffecient. The following is my 'data'. http://pastebin.com/VfLDk7Lh. The data is already in $\ln(\sqrt{R})$, energy. Here is the code that I have keyed into mathematica.               {Reflec, w} = ToExpression@Import["C:\\Users\\user\\Desktop\\1.txt"];          f = Interpolation[Transpose[{Flatten[w], Flatten[Reflec]}]]          delta[w_] :=      delta[w] = -2 w/Pi NIntegrate[(f[a] - f[w])/(a^2 - w^2), {a, 0, 10},      Method -> "PrincipalValue", Exclusions -> {(a^2 - w^2) == 0}] //      Quiet          Table[delta[w], {w, 0, 10, 0.1}]       _Mathematica_ is able to give me some values $\Theta(\omega)$. However, when I calculated the dielectric $\varepsilon_2$ with another program IGOR, there are some negatives values. Hence, I would like to find out if there are anything wrong with the commands I typed in _Mathematica_.