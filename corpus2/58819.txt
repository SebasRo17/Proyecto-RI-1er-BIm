I'm trying to simulate a simple circuit with Mathematica. The equation of the circuit is $R \dfrac{dQ}{dt} + \dfrac{Q(t)}{C} = f_{sig}(t)$. This is the definition of $f_{sign}$, and the function seems to work, since the plot is good.               newfSign[t_] :=        If[OddQ[Floor[t/τ]], 1/2*Subscript[V, max] (Cos[2*π *β*t/τ] + 1), Subscript[V, max]]      ![Plot of $f_{sign}](http://i.stack.imgur.com/8PyFM.png) This is the definition of the solution:               s = NDSolve[{R*Q'[t] + Q[t]/C2 == newfSign[t], Q[0] == 0}, Q, {t, 0, 4 τ}]      And I try to plot it with this command:               Plot[Q[t]/C2 /. s, {t, 0, 4 τ}, PlotRange -> All]      Getting this result, which is not what would be expected, given the forcing function $f_{sign}$. ![Plot of NDSolve](http://i.stack.imgur.com/khzgo.png) Those are the values I'm using:               Subscript[V, max] = 5     β = 10     τ = 500*10^-6     R = 2000     C2 = 0.22*10^-6      Am I missing something?