I'm trying to write a script that matches a particular element to a coordinate. Let's say there are 24 coordinates; and that fractionally a:b:c:d:e is 18%:18%:18%:18%:27%. Instead of matching 4 of a, b, c, and d to individual coordinates and e to the final 8 (to a sum of 24), I want to generate a list of 24 points from my initial list of a,b,c,d,e and those percentages and then randomly pair them to available coordinates. The current code I'm using is below, is there an easier way to do this? Inputs:               elements = Transpose[{{aa, bb, cc, dd, ee}}]     xelement = {0.09, 0.09, 0.09, 0.09, 0.18};     spin = Transpose[{{"Spin=4", "Spin=3", "Spin=3", "Spin=2",       "Spin=2"}}];          PosFCC = {     {0.000000, 0.250000, 0.500000 },      {0.166667, 0.750000, 0.000000 },      {0.333333, 0.750000, 0.500000 },      {0.666667, 0.750000, 0.500000 },      {0.833333, 0.500000, 0.500000 },      {0.833333, 0.250000, 0.000000 },      {0.333333, 0.500000, 0.000000 },      {0.500000, 0.750000, 0.000000 },      {0.833333, 0.750000, 0.000000 },      {0.000000, 0.000000, 0.000000 },      {0.000000, 0.500000, 0.000000 },      {0.333333, 0.000000, 0.000000 },      {0.000000, 0.750000, 0.500000 },      {0.500000, 0.000000, 0.500000 },      {0.166667, 0.000000, 0.500000 },      {0.166667, 0.250000, 0.000000 },      {0.666667, 0.500000, 0.000000 },      {0.500000, 0.500000, 0.500000 },      {0.666667, 0.250000, 0.500000 },      {0.166667, 0.500000, 0.500000 },      {0.333333, 0.250000, 0.500000 },      {0.666667, 0.000000, 0.000000 },      {0.500000, 0.250000, 0.000000 },      {0.833333, 0.000000, 0.500000}      };      Current Code:               pos1 = ArrayFlatten[{{elements, spin}}];     For[       (i = 1) && (balance = 0) && (store = pos1),       i < Dimensions[pos1][[1]] + 1,       i++,       (For[          j = 1,          j < (If[             balance > 1.01,             ((Round[xelement[[i]]*Dimensions[PosFCC][[1]]]) + 1),             (Round[xelement[[i]]*Dimensions[PosFCC][[1]]])             ]),          j++,          store = Insert[store, pos1[[i]], 1]          ])        &&        (If[          balance > 1.01,          balance = 0,           balance =            balance + (xelement[[i]]*Dimensions[PosFCC][[1]] -               Round[xelement[[i]]*Dimensions[PosFCC][[1]]])          ]         )       ];          pos2 = RandomSample[store];     pos3 = Transpose[Insert[Transpose[PosFCC], pos2[[All, 1]], 1]];     pos4 = Transpose[Insert[Transpose[pos3], pos2[[All, 2]], 5]];     posd = TableForm[pos4, TableSpacing -> {0, 5}];      Output:               bb     0.           0.25     0.5     Spin=3     dd     0.166667     0.75     0.      Spin=2     dd     0.333333     0.75     0.5     Spin=2     bb     0.666667     0.75     0.5     Spin=3     cc     0.833333     0.5      0.5     Spin=3     ee     0.833333     0.25     0.      Spin=2     aa     0.333333     0.5      0.      Spin=4     dd     0.5          0.75     0.      Spin=2     ee     0.833333     0.75     0.      Spin=2     bb     0.           0.       0.      Spin=3     aa     0.           0.5      0.      Spin=4     ee     0.333333     0.       0.      Spin=2     ee     0.           0.75     0.5     Spin=2     aa     0.5          0.       0.5     Spin=4     bb     0.166667     0.       0.5     Spin=3     bb     0.166667     0.25     0.      Spin=3     aa     0.666667     0.5      0.      Spin=4     cc     0.5          0.5      0.5     Spin=3     aa     0.666667     0.25     0.5     Spin=4     dd     0.166667     0.5      0.5     Spin=2     dd     0.333333     0.25     0.5     Spin=2     cc     0.666667     0.       0.      Spin=3     cc     0.5          0.25     0.      Spin=3     cc     0.833333     0.       0.5     Spin=3