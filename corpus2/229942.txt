I have a database that is ACID. And I have a different data storage that is not relational or acid compliant. Let's say its just a bunch of blobs or files. I want to make sure that these two data stores are in sync, so if someone creates a new file the database has a record created. If someone deletes the file the record is deleted. and the other way around. and one operation cannot happen without the other one happening as well, "if someone wants to put a book in the library they have to put the book in the index". How to make sure this happens? If I create a process that remembers one action and expects the other one, what happens if the process dies before completing the second action? Should I create some kind of a write ahead log that says "I am about to do these two things, if you are reading this I died trying to do X, please undo Y"?