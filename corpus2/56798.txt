I'm a Mathematica noob, running a trial version for the moment, but have run into the wall trying to handle this in Excel and am looking for other options. While running a benchmark application I'm gathering output from the Linux command "mpstat -P ALL 1" and exporting it to a CSV. The data is as follows:               Time, CPU, %usr, %nice, %sys, %iowait, %irq, %soft, %steal, %guest, %gnice, %idle      10:11:04 AM, all, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00     10:11:04 AM, 0, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00     10:11:04 AM, 1, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00     10:11:04 AM, 2, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00     ...     more interesting data in the middle     ...     11:18:55 AM, 12, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00     11:18:55 AM, 13, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00     11:18:55 AM, 14, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00     11:18:55 AM, 15, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 0.00, 100.00      There are 21 unique tests in the benchmark which are clearly visible when each sample with "CPU = all" is graphed. (The Y axis is calculated as (100 - %idle). ![Excel Graph of "ALL" CPU utilization over Time](http://i.stack.imgur.com/sePMO.png) What I need to do is the following:   * Separate the idle periods from the periods when the benchmark is running. (There are short idle periods before testing starts, in-between each test, and an idle period after all tests are complete.) This is the part that gives me the biggest problem since the number of idle samples between tests is not entirely predictable.   * For each period when the performance test is running, find the average CPU utilization for each CPU (0, 1, 2, ..., 14, 15, all).   * Create a table that indicates the test name (e.g. Test 1, Test 2, etc.) and the average CPU utilization for each CPU sampled. > >     +--------+---------+-------+-------+-------+-------+ >     |  Test  | CPU ALL | CPU 0 | CPU 1 | CPU 2 | CPU 3 | >     +--------+---------+-------+-------+-------+-------+ >     | Test A |   30%   |  25%  |  35%  |  24%  |  36%  | >     +--------+---------+-------+-------+-------+-------+ >     | Test B |   25%   |  20%  |  31%  |  24%  |  30%  | >     +--------+---------+-------+-------+-------+-------+ >     ... >   The full data source can be found here: mpstat.zip