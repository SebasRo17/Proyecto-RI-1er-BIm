I'm having some fun writing a brainf*** interpreter in Mathematica. See this wiki article for more info. It works nicely but I'd like to find an elegant, preferably functional, way to handle the looping structures. This is a simple example of what I'm hoping to do with the solution I currently have in place. The variable `ptr` is the position of a pointer in the program. The variable `paren` is used to keep track of the brackets, it increments on "[" and decrements on "]" so it should be zero when I find the proper closing bracket.               ptr = 1;     paren = 1;     lst = {"[", "[", "-", "]", ">", ">", ">", ".", "<", "<", "<", "]",              ">", ">", ">", ">", ">", ">", "."};          While[paren > 0, ptr++;           Switch[lst[[ptr]], "[", paren++, "]", paren--, _, Null]]      Which tells me the closing "]" is located at position 12 in `lst`.               In[287]:= ptr          Out[287]= 12      Is there a more elegant and/or efficient way to do this?