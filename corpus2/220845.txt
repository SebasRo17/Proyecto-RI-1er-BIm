I would like to move some business logic out of my application and into a stored procedure or function. I am willing to change rdbms as the system is being updated/re-written. Right now it's Access 97 (see why it's being updated?) but a while ago when I last looked, SQLserver couldn't handle it either. At least I couldn't see how. The basic problem is this- An assembly gets used, and the use is logged. I need to apply the use to the sub-assemblies, and their sub-assemblies, and so on until I end up at the elemental parts of the assembly. Maybe four or five levels deep. Knowing how many parts were made per hour I calculate how many "uses" each part received. The tricky bit is that the sub-assemblies can be changed out during the usage. For example, a machine runs for 40 hours, and the tooling sub-assembly is changed four times. Sometimes the clamp bolt on the tooling is changed but the tooling sub-assembly is not. I have the on and off timestamps when things - sub-assemblies and/or parts - were installed and removed, and what they were installed on in a history table. Currently I have code that calculates how many parts were made by the machine, and then looks for any sub-assemblies installed on the machine and calculates how many parts each installed assembly made, then looks at things installed on that until I run out of children. Surely some rdbms has come along since Access 97 that can do such a thing? Thanks!