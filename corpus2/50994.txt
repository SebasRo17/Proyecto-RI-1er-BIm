I am trying to calculate the following integral.               sigma1 = 10.0; sigma2 = 5.0; delta = 0.5;     t[x1_, y1_, x_, y_] := 100*HeavisideLambda[sigma1^-1*(x - x1), sigma2^-1*(y - y1)];     B2[x1_, y1_, x_, y_] := HeavisideTheta[(delta/2)^2 - (x - x1)^2, (delta/2)^2 - (y - y1)^2];     trans[x1_, y1_, x2_, y2_] :=         NIntegrate[B2[x1, y1, xz, yz]*t[xz, yz, xp, yp]*            (B2[x2, y2, xz, yz] - B2[x2, y2, xp, yp]),             {xp, x2 - 2.0*sigma1, x2 + 2.0*sigma1},             {yp, y2 - 2.0*sigma2, y2 + 2.0*sigma2},             {xz, x1 - 0.5*delta, x1 + 0.5*delta},              {yz, y1 - 0.5*delta, y1 + 0.5*delta},          WorkingPrecision -> 12, AccuracyGoal -> 8, MinRecursion -> 8, MaxRecursion -> 100];      I am interested in the value of the integral for the following inputs:               trans[0, 0, delta, 0]      Here is my problem: for values of delta greater than 0.5 (I tried 1.0, 0.9, 0.8, 07, 0.6, 0.515), the result is a negative number, and it takes some time for _Mathematica_ to come up with the result. For any value of delta smaller than 0.5, _Mathematica_ immediately returns 0, and doesn't give any hints about what is wrong. This is a part of a refinement study and I need to choose smaller and smaller values for delta. Do you know how I can make this work?