I'm trying to solve a pair of coupled ODEs with NDSolve. I know roughly what the solution should look like (both should give periodic functions, pi/2 out of phase, the amplitude of which damp towards a common limiting value), but I am trying to work out what the limiting amplitude is for a range of parameters. For certain choices of parameters, the solution looks how I would expect, but for others the NDSolve sporadically takes very large steps and the output either diverges, becomes constant, or shows other noisy/glitchy behaviour. Changing the NDSolve range also makes these effects come and go, and reducing the MaxStepSize or changing the Working Precision to anything but 16 makes things worse - so I'm pretty sure this is a computational problem. I'm pretty new to Mathematica so this is probably something simple, but every suggestion I've seen in other posts (increasing workingprecision, limiting step size etc) has only made things worse so I'm a bit stumped!               ( _Define some constants_ )     wc0 = 0.9645*^8*B/mass /. {mass -> 40, B -> 1.845};     fc0 = wc0/2/[Pi];     ( _Define wz, w1, wc and wm as functions \     of trap voltage V_ )     wz[V1_] = Sqrt[4*0.9645*^8*1*V1/40/0.0189^2];     w1[V1_] = Sqrt[wc0^2/4 - wz[V1]^2/2];     wc[V1_] = wc0/2 + w1[V1];     wm[V1_] = wc0/2 - w1[V1];     ( _Want to find limiting value as these parameters are varied_ )     V = 244;     d = 100000;     rate = 2*^6;     rm0 = 5*^-6;     rc0 = 5*^-6;     ( _Solve for dynamics_ )     mysolve =        NDSolve[{           rc'[t]==rate*B/w1[V]^2/2/rc[t]-rate*wc[V]*A*rc[t]/w1[V]/2+d*rm[t],           rm'[t]==rate*B/w1[V]^2/2/rm[t]+rate*wm[V]*A*rm[t]/w1[V]/2-d*rc[t],            rm[0] == rm0, rc[0] == rc0} /. {B -> 3.4*^-4, A -> 3*^-3},           {rc[t], rm[t]}, {t, 0, 0.009}, MaxSteps -> Infinity           ];                              range = 1*^-6;     ( _Plot dynamics_ )     Plot[Evaluate[rc[t] /. mysolve], {t, 0.0, 0.008},       PlotRange -> {-range, range}, AspectRatio -> 0.25, ImageSize -> 800]     Plot[Evaluate[rm[t] /. mysolve], {t, 0.0, 0.008},       PlotRange -> {-range, range}, AspectRatio -> 0.25, ImageSize -> 800]                              ( _Find limiting value_ )     intmin = 0.004;     intmax = 0.008;     lrc = Sqrt[2*NIntegrate[Evaluate[rc[t]^2 /. mysolve], {t, intmin, intmax}]/(intmax-intmin)]     lrm = Sqrt[2*NIntegrate[Evaluate[rm[t]^2 /. mysolve], {t, intmin, intmax}]/(intmax-intmin)]                    (**)      The parameters listed above give a sensible result (first image) - but if, for instance, I change the NDSolve window to {t,0,0.004} or {t,0.04}, or change 'd=100000' to 'd=80000' (second image) it starts behaving strangely. Any help would be very much appreciated! ![Expected behaviour for settings listed above](http://i.stack.imgur.com/9dVN6.jpg) ![Glitchy behaviour when parameter changed \(here d=80000\)](http://i.stack.imgur.com/cp4Zf.jpg)