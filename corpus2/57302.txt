Given a tiled background and a depth map, both of the same dimension, I tried to produce a stereogram using the following codes which was adopted from the method given by Simon Woods, but in a simplified way. However, there are defects in the outcomes. What is wrong in the codes?               depMap = Import["http://i.stack.imgur.com/RvZZT.jpg"];     flower = Import["http://i.stack.imgur.com/9vmBl.jpg"];     {wid, hei} = ImageDimensions[flower]     imData = ConstantArray[{0, 0, 0}, {hei, wid}];     imc = ImageCrop[flower, {32, hei}, Right];     exflower = ImageData[ImageAssemble[{flower, imc}]];     shift = Round[32 ImageData[depMap]] ;          For[r = 1, r <= hei, r++,       For[c = 1, c <= wid, c++,        imData[[r, c]] = exflower[[r, c + shift[[r, c]]]]]];     Image[imData]      Depth map: `(800x632)` ![enter image description here](http://i.stack.imgur.com/RvZZT.jpg) Tiled background: `(800x632)` ![enter image description here](http://i.stack.imgur.com/9vmBl.jpg) Outcome: A pyramid of flowers is expected, but instead there are a triangular stack and a triangular hole. ![enter image description here](http://i.stack.imgur.com/5ns4e.jpg)