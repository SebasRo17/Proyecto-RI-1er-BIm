I need to do complex dependency processing during the installation of our solution, install a few related programs from their own installers and also probably run a few simple tests to determine performance of the machine to choose the right parameters for our application. I'm thinking something like Lua would be a great fit for this task, yet all scripting in installers I found so far is something like Pascal script of Inno Setup which leaves a lot to be desired and NSIS scripting language is nonexistent. I guess I'm missing something really obvious here as my task is not unique and has probably been solved before.