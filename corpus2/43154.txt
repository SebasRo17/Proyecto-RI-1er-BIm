Inserting a nested subtotal in a spreadsheet is a facility that Excel performs very well.   But if a subset of this facility can be implemented in MMA for a table which needs it the hassle of its export/import will be avoided.   As an example I have the following 3-columns matrix, the first two columns of which I want subtotals values for. The matrix was sorted so that the rows I want subtotaled are grouped together:.               data = {{Pi, A, 15}, {Pi, B, 20}, {Pi, B, 10}, {Pi, C, 20}, {Pi/2, A,      1}, {Pi/2, B, 2}, {Pi/2, B, 3}, {Pi/3, B, 10}}      And I want this result in separate matrix from the input data.               result = {{π, A, 15}, {π, B, 30}, {π, C, 20}, {π,      "∑", 65}, {π/2, A, 1}, {π/2, B, 5}, {π/2,      "∑", 6}, {π/3, B, 10}, {π/3, "∑",      10}, {"∑", "∑", 81}} // MatrixForm      ![Mathematica graphics](http://i.stack.imgur.com/N4aUr.png) I came up with a partial result,and what remains is too challenging for me (it is wrong to group results only on breaks in column 2.)               {#[[1, 1]], "∑", Total[#[[All, 3]]]} & /@ SplitBy[data, First] (* subtotals col1 *)     { "∑", "∑", Total[#[[All, 3]]]} & /@ {data} (*grand total *)      I would like to have a generalised answer, valid for more than two columns for subtotals as in the example I gave here.