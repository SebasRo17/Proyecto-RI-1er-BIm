I'm new here, so please be gentle with me and hopefully the post is appropriate and not too basic. I am a math teacher and use modeling in my courses. I had working code (in v8 of Mathematica) for a cancer model with discontinuous forcing and now that previously working code doesn't work with v9. The model can be found displayed at ![Antiangiogenic Model](http://www.biomathdynamics.com/antiangiogenics/antiangiogenicModel.jpg) The following code worked in Mathematica version 8 but now doesn't work under version 9 (I haven't tried it in v10 yet):               lambda1 = 0.192; lambda2 = 0.000; b = 5.85; d = 0.00873; dose = 30;      efficacy = 0.66; clearance = 1.7; numberofdoses = 30; doseinterval = 2;      t0 = 0; tfinal = 84; v0 = 185; k0 = 625; is = 840;          h[t_] = Integrate[Sum[DiracDelta[tau - doseinterval*i], {i, 1, numberofdoses}]*Exp[-clearance*(t - tau)], {tau, 0, t}];          f := -lambda1*v[t]*Log[v[t]/k[t]];          g := -lamda2*k[t] + b*v[t] - d*k[t]*(v[t])^(2/3) - efficacy*dose*h[t]*k[t];          eqns := {v'[t] == f, k'[t] == g, v[0] == vinit, k[0] == kinit};          sol := NDSolve[eqns /. {vinit -> v0, kinit -> k0}, {v[t], k[t]}, {t, t0, tfinal}, MaxSteps -> 10000, MaxStepSize -> 1];          g1 := Plot[h[t], {t, t0, tfinal}, PlotStyle -> {Thick, Black}, AxesLabel -> {time, " "}, PlotLabel -> Treatment, ImageSize -> is];          g2 := Plot[Evaluate[{v[t], k[t]} /. sol], {t, t0, tfinal}, PlotStyle -> {{Thick, Blue}, {Thick, Red}}, AxesLabel -> {time, volume}, ImageSize -> is, PlotRange -> All, PlotLabel -> Response];          g3 := ParametricPlot[Evaluate[{v[t], k[t]} /. sol], {t, t0, tfinal}, ImageSize -> is, PlotStyle -> {Thick, Black}, AxesLabel -> {Vasculature, Tumor}];          g4 := Show[GraphicsGrid[{{g1}, {g2}, {g3}}]];          g4      Partial output, found at the link below, should be obtained ![Output for TNP470 Parameters](http://www.biomathdynamics.com/antiangiogenics/tnp470.jpg) What gives? I get the following beginning error message:               NDSolve::deqn: Equation or list of equations expected instead of ConditionalExpression[(k^\[Prime])[t]==-lamda2 k[t]-1.04875*10^45 E^(-1.7 t) (1. HeavisideTheta[Plus[<<2>>]]+0.0333733 HeavisideTheta[Plus[<<2>>]]+<<27>>+1.50857*10^-43 HeavisideTheta[Plus[<<2>>]]) (-0.5+1. HeavisideTheta[t]) k[t]-0.00873 k[t] v[t]^(2/3)+5.85 v[t],t\[Element]Reals] in the first argument {(v^\[Prime])[t]==-0.192 Log[v[t]/k[t]] v[t],ConditionalExpression[(k^\[Prime])[t]==-lamda2 k[t]-1.04875*10^45 E^(-1.7 t) (1. HeavisideTheta[<<1>>]+0.0333733 HeavisideTheta[<<1>>]+<<27>>+1.50857*10^-43 HeavisideTheta[<<1>>]) (-0.5+1. HeavisideTheta[<<1>>]) k[t]-<<1>>+5.85 v[t],t\[Element]<<5>>],<<1>>,k[0]==625}. >>      And there are other error messages seemingly related to this issue. Can you please help me out so I can get the model up and running for my students again? Thanks in advance for any help. I get the sense it's in how NDSolve handles discontinuous forcing functions. Is there a workaround? Mike