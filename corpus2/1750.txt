I am trying to calculate the change of the refractive index from the change of the absorption coefficient using the Kramers-Kronig relations, in Mathematica.               c = 300000000;          daF[l_] = 500 * 0.28 Exp[-((l - 500)/90)^2];          dnFpoints = Table[         {             ln,             c/Pi NIntegrate[                 daF[li] / ((2 Pi c 10^9 /li)^2 - (2 Pi c 10^9 / ln)^2),                 {li, 800, 200},                 Method -> {"PrincipalValue"},                 Exclusions -> ((2 Pi c 10^9 /li)^2 - (2 Pi c 10^9 / ln)^2) == 0             ]         },         {ln, 300, 600}     ];      Unfortunately, Mathematica displays an error that it does not converge to prescribed accuracy and the output is junk (I would expect a smooth curve with a negative minimum first and then a positive maximum). I am using version 8, if it matters. Any ideas?