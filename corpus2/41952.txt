In a dll library I have the `C` function `DRV_DioReadBit`, containing the structure `PT_DioReadBit`. The C++ declaration is:               FEXPORT LRESULT FTYPE DRV_DioReadBit(LONG_PTR DriverHandle, LPT_DioReadBit lpDioReadBit);       The structure `PT_DioReadBit` contains the pointer `*state` as below:                typedef struct tagPT_DioReadBit     {         USHORT      port;         USHORT      bit;         USHORT far  *state;          } PT_DioReadBit, FAR * LPT_DioReadBit;      The `lpDioReadBit` is a pointer to the structure `PT_DioReadBit` that stores target port number `USHORT port`, bit order number `USHORT bit` and returned bit status `USHORT *state`. I set the port and the bit, then I want to read the state. How can I extract this information (the value of the variable "state") by using `DefineDLLFunction` in _Mathematica_? I tried the following code: digreadbit = DefineDLLFunction[" [StructLayout(LayoutKind.Sequential, Pack=1)] public class PT_DioReadBit { public ushort port; public ushort bit; public ushort state; } [DllImport(\"Adsapi32.dll\")] public static extern Int32 DRV_DioReadBit (int DriverHandle, ref PT_DioReadBit DioReadBit)"] ctxt = Context[ Evaluate@First@Cases[digreadbit, If[ _, sym_ [_], _] :> sym]]; typeName = StringDrop[StringReplace[ctxt, "`" -> "."], -1] <> "+PT_DioReadBit"; structreadbit = NETNew[typeName] structreadbit@port = 1; structreadbit@bit = 0; error = digreadbit[placa1742, structreadbit] structreadbit@state When I call the function via error = digreadbit[placa1742, structreadbit], I obtain an error. What's wrong in my syntax?