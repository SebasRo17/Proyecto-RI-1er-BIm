I am trying to implement a promotions engine for an e-commerce application and I want to figure out how such engines work especially in situations like the following. > Buy X Items from Category A Get Y Items from Category B at Z% discount If the order contains many different items from category A how the engine selects the items that trigger the promotion since there can be many combinations of items that qualify and some combinations make the rule not applicable. A brute force approach would be to find all possible combinations of items that qualify and stop when the rule applies successfully. Are there any algorithms for this or other promotion patterns that I can use?