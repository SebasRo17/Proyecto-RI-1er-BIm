I need to enumerate all the simple cycles (i.e. elementary cycles where no vertex is repeated other than the starting) of a graph which has both directed and undirected edges, where we can treat the undirected edges as doubly directed. (Specifically, I am looking at the Cayley graphs of S3 and S4, which can be produced using `CayleyGraph[SymmetricGroup[3]]` and `CayleyGraph[SymmetricGroup[4]]` respectively.) I have tried two ways of doing this so far. First, I have tried using `ExtractCycles` in the _Combinatorica_ package, as detailed in this answer by TomD. For example, entering the ordered pairs for S3 (as "el"):               el = {{1, 2}, {1, 4}, {2, 3}, {2, 5}, {3, 1}, {3, 6}, {4, 1}, {4, 6}, {5, 4}, {5, 2},      {6, 5}, {6, 3}}      And then using:               Needs["Combinatorica`"]     ExtractCycles@FromOrderedPairs@el      returns:               {{5, 4, 6, 5}, {6, 3, 6}, {5, 2, 5}, {4, 1, 4}, {3, 1, 2, 3}}      However, that set is incomplete - what about e.g. `{{5, 4, 1, 2, 5}, {5, 4, 1, 2, 3, 6, 5}}`? These are simple cycles, so why are they not included in the list? The output for S4 is also much truncated (obviously we would expect a _lot_ of cycles there, but the output gives only eighteen). The second thing I tried was this answer by kguler. Taking the example of S3, using `CycleGraph[3, DirectedEdges -> True]` gave the right results, but `CycleGraph[4, DirectedEdges -> True]` did not - i.e. the cycles `{5, 4, 1, 2, 5}` etc. were not picked up again. Presumably this is something to do with the doubly directed edges? Any help with this would be much appreciated! **Edit:** As requested, the ordered pairs for the Cayley graph of S4 are:               el2 = {{1, 2}, {1, 9}, {2, 3}, {2, 17}, {3, 4}, {3, 13}, {4, 1}, {4, 5}, {5, 4}, {5, 6},     {6, 16}, {6, 7}, {7, 8}, {7, 22}, {8, 5}, {8, 10}, {9, 1}, {9, 10}, {10, 8}, {10, 11},     {11, 12}, {11, 21}, {12, 9}, {12, 18}, {13, 14}, {13, 3}, {14, 15}, {14, 20}, {15, 16},     {15, 23}, {16, 13}, {16, 6}, {17, 2}, {17, 18}, {18, 19}, {18, 12}, {19, 24}, {19, 20},     {20, 17}, {20, 14}, {21, 11}, {21, 22}, {22, 7}, {22, 23}, {23, 15}, {23, 24}, {24, 19},     {24, 21}}