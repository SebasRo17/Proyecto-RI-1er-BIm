These days it's possible to hash a file client-side, send the hash to the server, and have the server check whether or not that file is already uploaded. If it is, we can skip the file upload and make it appear to upload almost instantly to the user. This can also save have oodles of bandwidth for a large site. This has some important security implications, however.   1. If the user is clever, he can use this information to determine what files are already on the server, including illegal or sensitive documents   2. He can produce millions of fake hashes, send them to the server, and hope for a collision to gain access to random documents   3. There is a legitimate but unintentional collision where the hashes are the same, but the file is actually different My question is: is it worth the trade-off? Can we mitigate some or all of these problems? How?