I simplify my real problem as follows: I define a rule function as               Clear[rule];      rule[i_] := tt -> i;      the real rule function is not this simple. I define a matrix function as               Clear[hh];     hh[x_, y_, i_] := {{tt, x}, {y, 1}}/. rule[i];      I want to define a function `hhpar` that will differentiate `hh` with respect to `x`, so I write               Clear[hhpar];     hhpar[x_, y_, i_] := D[hh[x, y, i], x];      This doesn't work and I know why. But I still can't figure out a way to write a proper `hhpar`. How would I do that?