My company is looking to develop and release an open source software project along with a proprietary enhanced version, similar to pre-4.0 VirtualBox. What is the best way to maintain the two code bases such that changes to the open source version can easily be incorporated into the commercial version with minimal risk of accidentally pushing proprietary code to the open source product?