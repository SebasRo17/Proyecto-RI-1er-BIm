This question is an extension of the question I asked here Histogram of runs. What I would like to do now is generate a Histogram3D that has the run duration on the x axis and the mean level on the y axis. The code given by kguler and VF1 in the previous post generate the duration that I need but I've been having trouble modifying the code to get the mean value along with the run duration. Any help would be greatly appreciated. This is a plot of the input data; ![enter image description here](http://i.stack.imgur.com/UYmPH.png) This is a plot of the 3d histogram using VF1s code; ![enter image description here](http://i.stack.imgur.com/Aux6C.png)