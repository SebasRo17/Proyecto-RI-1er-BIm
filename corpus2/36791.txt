I am trying to find the orientation and position of a polygon resting on a curved surface under gravity.The polygon **MUST** not be penetrated by any part of the surface below. Here is an example for a square shape.![enter image description here](http://i.stack.imgur.com/mgQp6.jpg) The curved surface is defined by a 2D Matrix: Tdata. The problem can be formulated to a constrained Optimization problem. The initial square can be approximated by five points(four vertices and one center point):               ConVer = {{l/2, w/2, 0}, {l/2, -w/2,0}, {-l/2, -w/2, 0}, {-l/2, w/2,0}, {0, 0, 0}};      Where l is the length and w is the width of the Square. The square's orientation is parameterized by three angles:               Rθ = RotationMatrix[θ, {0, 0, 1}];     Rψ = RotationMatrix[ψ, {0, 1, 0}];     Rϕ = RotationMatrix[ϕ, {1, 0, 0}];      Then the parameterized square is               For[i = 1, i < 6, i++, ConVer[[i]] =Rθ.Rψ.Rϕ.ConVer[[i]] + {x, y,z}];      Where {x ,y ,z} is the coordinates of the center point of the square. The optimization uses NMinimize function:               x = 1; y = 1; θ = 0;     NMinimize[{z,                  Tdata[(ConVer[[1]])[[1 ;; 2]]] <= (ConVer[[1]])[[3]] &&                  Tdata[(ConVer[[2]])[[1 ;; 2]]] <= (ConVer[[2]])[[3]] &&                          Tdata[(ConVer[[3]])[[1 ;; 2]]] <= (ConVer[[3]])[[3]] &&                  Tdata[(ConVer[[4]])[[1 ;; 2]]] <= (ConVer[[4]])[[3]] &&                  Tdata[(ConVer[[5]])[[1 ;; 2]]] <= (ConVer[[5]])[[3]]},                  {{ψ, -Pi/4, Pi/4}, {ϕ, -Pi/4, Pi/4}, {z, 0, 1}}];      When Tdata is a 2d function this works well, but as to 2d Matrix error occurs! Why is that? I also tried to solve this problem in Matlab using 'fmincon', and Matlab can return desired result.