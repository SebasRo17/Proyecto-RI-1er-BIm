Is there a better way to write this gather? I have a list of particles, "particlelist", and a list of particle coordinates, "coordlist" and I want to put all the particles into a 3-dimensional ng x ng x ng array of cubic boxes of width d. Each coordinate takes values between xmin and xmin + d x ng. boxIndx contains the correct box for any particle given the particle coordinates. I can then place the appropriate particle into its proper box. The code below is easy to read but it is a little slow. I know that AppendTo's are supposed to be no-no's but replacing it with Reap and Sow results in even slower times. The test problem typically takes .13-.17 on my Mac laptop. Thanks.               BoxEmUp3[coordlist_, particlelist_, ng_, d_, xmin_] :=         Module[{ParticleListByBox,particleIndx, boxIndx},            ParticleListByBox = ConstantArray[{}, ng^3];       Do[        boxIndx = 1 + Floor[(coordlist[[particleIndx, 1 ;; 3]] - xmin)/d].{1, ng, ng^2};             AppendTo[ParticleListByBox[[boxIndx]], particlelist[[particleIndx]]];,             {particleIndx, Length[particlelist]}];       Return[ParticleListByBox];]          xyztst = RandomReal[{-10, 10}, {10^6, 3}];     free = RandomSample[Range[10^6], 10^4];     BoxEmUp3[xyztst[[free]], free, 20, 1., -10] // Timing