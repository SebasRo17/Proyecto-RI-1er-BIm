I wanted to draw (lattice-aligned) unit cubes inside a sphere with a given radius centered on the origin, so I wrote this program:               Cube[x_, y_, z_] := Cuboid[{x - 1, y - 1, z - 1}, {x, y, z}];     Coords[r_] := {#1, #2, Floor[Sqrt[r^2 - #1^2 - #2^2]]} & @@ # & /@         With[{t = Sqrt[r^2 - 1]},          Select[Flatten[Table[{x, y}, {x, 1, t}, {y, 1, x}], 1],           Norm[#] <= t &]];     Cubes[r_] :=        Cube @@ # & /@         Union[Flatten[Permute[#, SymmetricGroup[3]] & /@ Coords[r], 1]];     Draw[r_] :=        Graphics3D[        Union[Cubes[r], {{Green, Opacity[0.1], Sphere[{0, 0, 0}, r]}}],         PlotRange -> {{0, r}, {0, r}, {0, r}},         ViewPoint -> {r, 3 r/4, 3 r/5}];     Draw /@ Sqrt /@ {50, 100, 250, 500, 1000, 2500, 6054}      (Note that it shows only the cubes on the outside -- drawing the inner ones takes too long and usually Mathematica runs out of memory.) It gets the job done, but it's pretty ugly. I'm not a regular Mathematica user, and tips for improving my code? That is, how can I write idiomatically-better Mathematica code? * * * Improved code:               Coords[r_] := {#1, #2, Floor[Sqrt[r^2 - #1^2 - #2^2]]} & @@@         With[{t = Sqrt[r^2 - 1]},          Select[Join @@ Table[{x, y}, {x, t}, {y, 1, x}], Norm[#] <= t &]];     Cubes[r_] := (Cuboid /@ (Union @@ (Permute[#, SymmetricGroup[3]] & /@               Coords[r]) - 1));     Draw[r_] :=        Graphics3D[        Union[Cubes[r], {{Green, Opacity[0.1], Sphere[{0, 0, 0}, r]}}],         PlotRange -> {{0, r}, {0, r}, {0, r}},         ViewPoint -> {r, 3 r/4, 3 r/5}];     Draw /@ Sqrt /@ {50, 100, 250}