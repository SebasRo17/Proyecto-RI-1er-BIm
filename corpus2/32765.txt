### Cross-posted at the Wolfram community forum I have found this code on a forum, apparently it worked in a previous version of mathematica. Now when I run it, it keeps running for ages. I am not able to find the error.                ewa = FinancialData["NYSE:EWA", {{2006, 4, 4}, {2012, 4, 9}}, "Value"];      ewc = FinancialData["NYSE:EWC", {{2006, 4, 4}, {2012, 4, 9}}, "Value"];      data = Transpose@{ewa, ewc};      johansenProcedure[levels_?MatrixQ, p_Integer] /;      (Dimensions[levels][[ 1]] > (Dimensions[levels][[2]] + p)) :=      With[{N = Dimensions[levels][[1]], T = Dimensions[levels][[2]],      diff = Rest[levels - RotateLeft[levels]], ypt = Drop[levels, -p]},      Module[{x, r0t, rpt, s00, sop, cc, λ, vλ, logλ},     x = Join @@ (Drop[RotateLeft[diff, #], p - 1] & /@ Range[p]);     With[{q = Inverse[Transpose[x].x], y0t = Drop[diff, p - 1]},     r0t = y0t - x.q.Transpose[x].y0t; rpt = ypt - x.q.Transpose[x].ypt; s00 = (Transpose[r0t].r0t)/T; s0p = (Transpose[r0t].rpt)/T;     cc = Inverse[CholeskyDecomposition[(Transpose[rpt].rpt)/T]];     {λ, vλ} = Eigensystem[(cc.Transpose[s0p].Inverse[s00].s0p.Transpose[cc])];     logλ = Log[1 - λ];     {Reverse[-T* FoldList[Plus, First[logλ], Rest[logλ]]],     Reverse[-T logλ], Join[Reverse[Transpose[Transpose[cc].vλ]], s00, s0p]} ]]];          johansenProcedure[data, 10]      This is the error code               Dot::dotsh: Tensors {<<1>>} and {{0.38,0.42},{-0.21,-0.27},{0.03,0.13},{0.,-0.03},<<44>>,      {0.04,0.02},{-0.56,-0.63},<<1455>>} have incompatible shapes. Dot::dotsh: Tensors {<<1>>} and {{0.38,0.42},{-0.21,-0.27},{0.03,0.13},{0.,-0.03},<<44>>,{0.04,0.02},{-0.56,-0.63},<<1455>>} have incompatible shapes.      On guy suggested that this line was broken:               r0t = y0t - x.q.Transpose[x].y0t;      rpt = ypt - x.q.Transpose[x].ypt;       I have spent ages but are not able to figure out what to do, could someone give it a try?