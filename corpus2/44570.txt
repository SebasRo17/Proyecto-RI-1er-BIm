I have to fit a non linear model to my data and I am trying to use `nonlinearmodelfit`. The problem is that I have systematic errors, so the `weights` options is not a simple vector but a matrix. To be clear: my chi squared is written as:               (diff)T*(weight)^(-1)*(diff)      Where `diff` is the difference between my model and the data (T means trasposed). Does anyone have any idea? I use Mathematica 8.