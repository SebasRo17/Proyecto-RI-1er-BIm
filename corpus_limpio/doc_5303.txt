one andrew graphics gems glassner got collegue mine think fiddled little bit make deal whatever bizarre problem working time known work spl spheres asg feb spl thu mar est include stdioh include mathh define pi struct pointstruct double x z static double radius static double xorg static double yorg static double zorg dosphere r freq x z double r int freq double x double double z int pole double northy southy poley double rtheta ntheta magicangle double theta thetastart thisy den struct pointnode pnp struct pointstruct pt radius r xorg x yorg zorg z north pole magicangle northy radiussinmagicangle southy radiussinmagicangle pole poleyradius thisynorthy else poley radius thisysouthy theta thetastart theta theta rtheta poley radiuscosrtheta thisy radiussinrtheta thisy make ring go way normals right ptx pty ptz ptx pty ptz den den sqrtden den radius den den den sqrtden den radius den den den sqrtden den radius den body theta rtheta ntheta radiuscosrtheta northy radiussinrtheta northy radiuscosntheta southy radiussinntheta southy den den sqrtden den radius den den den sqrtden den radius den den den sqrtden den radius den den den sqrtden den radius den return define normptv register double r sqrt v x v x v v v z v z v x r v r v z r struct pointstruct int struct pointstruct struct pointstruct double den den den sqrtden den radius den den den sqrtden den radius den den den sqrtden den radius den else nothing special poly printf f f f f f fn xorg yorg zorg printf f f f f f fn xorg yorg zorg printf f f f f f fn xorg yorg zorg return