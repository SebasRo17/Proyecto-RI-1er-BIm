currently working numerical processing system deployed performance critical environment take input form numerical array use eigen library purpose question perhaps immaterial performs range numerical computation matrix product etc produce output array allocated statically size known compile time however input may invalid exceptional case still want computed still want output polluted invalid value used give example let take following trivial example pseudo matrix num num nan num matrix scalar b num matrix b result num num nan num idea num num num usable value nan signal recipient entry involved operation involved invalid discarded detected via std check used sound way communicating propagating unusable value given performance critical heap allocation option neither resource consuming construct boost optional pointer better way point quite happy current setup hoping get fresh idea productive criticism current implementation