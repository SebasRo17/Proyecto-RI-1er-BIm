w time h array non negative integer wish partition set coordinate c r leq c leq w leq r leq h subset subset corresponds cluster value array two coordinate neighbouring either top another one left corresponds finding cluster parallelogram belisarius nice provide picture enter image description code find one connected cluster array call gt floodfillextracttile gt sr sc module r c toexplore visited toexplore sr sc length toexplore pop r c last toexplore toexplore toexplore appendto visited r c left c r h gt r c gt r c memberq visited r c appendto toexplore r c right r h gt r c gt r c memberq visited r c appendto toexplore r c right r c w gt r c gt r c memberq visited r c appendto toexplore r c left r gt r c gt r c memberq visited r c appendto toexplore r c return visited floodfillextracttile gtp give component connected upper left hand corner however method feel ugly extending component feel even uglier looking gather problem want point cluster equal see example gather dependency list order edit type array looking one component respectively two component neighbour mean adjacent left right left right row stored like regular row rectangular matrix translates bit strange criterion neighbour gt pattern best code far first extract point value connected component analysis part getgttiles gtp module testsame testedge h w pt sameclusters getedges tile h w dimension gtp pt join table r c r h c w testsame r c r c gtp r c gtp r c testedge r c r c gtp r c gtp r c c c ab r r c c r r c c r r sameclusters gather pt testsame getedges clust join outer testedge sequence clust clust tile join connectedcomponents graph getedges sameclusters return tile output expect example given cluster found edit final code based belisarius solution gttiles gtp list module fromeuclidean toeuclidean getonetile element elmpos pt tile tile used changefrom different coordinate system fromeuclidean r c r c r toeuclidean r c r c r getonetile pt list maxdist numericq module f f nearest pt fixedpoint union flatten f infinity maxdist first pt element union gtp elmpos toeuclidean position gtp element really strange code tile flatten flatten reap nestwhile complement sow getonetile n sqrt elmpos tile map fromeuclidean tile return tile