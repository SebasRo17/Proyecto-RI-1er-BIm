trouble finding algorithm match fails match substring suffix list suffix hit finding suffix tree suffix array quite looking particular problem fully qualified hostname possibly malformed trying match suffix provided banned suffix list published mozilla concrete example given w x z example com need identify hostname w domain example com know example com valid domain example may need take example com know domain host matching com would wrong negative case get worse factor suffix like u jp cn eventual application dns hostname matching x509 certificate hence reason may malformed think algorithm log n log n lookup sorted list suffix dns label think may case seeing forest tree anyone know efficient algorithm matching substring list suffix