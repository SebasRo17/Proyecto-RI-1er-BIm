trying graphically display distance matrix similar element visually clustered group original matrix element random order first thing change ordering element using directagglomerate need hierarchicalclustering clusteringpermutation distancematrix linkage module index cluster index range length distancematrix cluster directagglomerate distancematrix index linkage linkage reverse clusterflatten cluster overall function permute matrix look like permutematrix distancematrix linkage module neworder neworder clusteringpermutation distancematrix linkage distancematrix neworder neworder given example matrix samplematrix permutematrix samplematrix single matrix rearranged similar cluster together plot result heat map applying permutation element label everything work fine get matrix x size case mathematica kernel crash reason evaluating directagglomerate limitation function something clearly wrong help would greatly appreciated definitely expert clustering perhaps completely different way go update tried use minimumbandwidthordering suggested bill quickly ran issue larger matrix group similar sample broken example msubset permutedmatrixorig permutematrix msubset single r c minimumbandwidthordering msubset method sloan r c minimumbandwidthordering msubset method rcmd refinementmethod none arrayplot msubset arrayplot permutedmatrixorig arrayplot msubset r c arrayplot msubset r c matriximage tried playing around method refinement option still unable fully group sample also noticed large matrix index row column different could something matrix fully symmetrical