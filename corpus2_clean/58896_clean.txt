want extract sorted data huge database based upon two key timely manner reproducible toy example two key n key randominteger n vals randomreal n data transpose key vals fastest traditional way found result sort case data r r much much faster v solution assoc merge association rule data identity use merge allow duplicate key time cost getting assoc important result sort assoc join assoc result result true speed comparison sort case data r r absolutetiming first sort assoc join assoc absolutetiming first certainly one reason upgrade two question remain could code improved b passing n result still work result run forever aborted