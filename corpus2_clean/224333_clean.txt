built mvc web application need several task different time interval also made application schedule task task manager window example application need send email every week summarizing program chosen use nuget razorengine package format email already show webpage using razorengine package use viewmodel email ui web project use template formatted email instead web therein lie problem viewmodel ui project think right thing application take dependency ui layer logical decision first make another layer app maybe also help better take dependency app ui app never seen done sure wise choice current layer project solution app dal dependency unit work repository pattern app service depends dal us dal business operation return relevant object actually iqueryable app ui depends service get back service run thru map business object appropriate view model render view using view model app depend service still need viewmodels us returned service render view formatted email send email layer view model view model builder go