want implement remainder tree based answer se come listproduct list time partition list nestlist listproduct prime range n r n r outer mod r final desired output calculate n mod p first n prime using remainder tree slow rather fast know wrong updated read somewhere method used faster sieve implementation around time faster available sieve method primo n product prime range n primeslist prime range prod primo n primo timing memberq listmod n primeslist false timing gcd n prod false