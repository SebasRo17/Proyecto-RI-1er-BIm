want factorize matrix ij ij sum k u ik v jk using variational method reason want minimize cost function f sum ij b ij respect u ik v jk b ij sum k u ik v jk ij use gradient descent find minimum therefore need calculate derivative f respect u ik v jk calculated easily hand example frac partial f partial u ik sum j b ij v jk however want see mathematica solves quite typical problem need use hand calculate much complex version problem code wrote kd x kroneckerdelta x u u b u c nonconstants u kd c kd b v v b v c nonconstants v kd c kd b b j sum u k v j k k infinity j f sum b j infinity j infinity assumption j k k element integer j k k f u k nonconstants u minute got result sum infty sum j infty left begin array begin array v j text k text text true end array end array right left j sum k infty u k v j k right elegant way evaluate simple derivative frac partial f partial u ik mathematica