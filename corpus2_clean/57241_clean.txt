expression like xx ff gg ff gg ff gg xx ff gg ff gg ff gg want transform special matrix creatematrix xx creatematrix xx logic creatematrix construct grid like using element xx ff gg ff gg ff gg ff gg say ff gg exists expression coefficient take place f gg grid element exist grid expression taken zero code work slow run double loop fill matrix creatematrix state elementsff union case state ff infinity elementsgg union case state gg infinity matrixsize length elementsff starttime absolutetime matrixsize dm identitymatrix matrixsize k k matrixsize k l l matrixsize l dm k l state elementsff k elementsgg l block ff ff dm dm print matrixconstr tostring absolutetime starttime starttime absolutetime dm return dm xx ff gg ff gg ff gg creatematrix xx small part code already optimized earlier partial question create faster algorithm given problem comparison test three huge matrix need later original approach second kguler solution second mr wizard solution second mr wizard solution second