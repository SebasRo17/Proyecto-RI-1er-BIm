safely efficiently elegantly select compatible option normally foo opts optionspattern module goodopts goodopts filterrules opts option bar bar goodopts loophole cause bug efficient elegant way