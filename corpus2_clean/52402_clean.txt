writing library generate check csrf token would like without use session cooky come num token generated current time unique token id unix timestamp unique token id num token would hashed using hmac returned would hmac hash unix timestamp unique token id could hidden form num library would test returned token extracting hash time unique token id compare returned hash one generated using returned time unique token id long hmac secret server stay secret secure missed something