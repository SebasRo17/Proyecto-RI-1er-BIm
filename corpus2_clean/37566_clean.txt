goal assemble sparsearray additive fashion let u assume large list index repeated generate simple test list index value ind randominteger val randomreal length ind value corresponds index ind would like build sparsearray way repeated index value summed array simply use sparsearray ind val first index encounter written sparsearray repeated index ignored current solution slow ugly solution slow shown make precise exactly trying accomplish pre allocate sparse array correct size use accumulate value index n ind randominteger n n val randomreal length ind sparsearray n n sequence ind val length val great tip working sparsearrays efficient element update sparsearrays sparsearray row operation clever combination gatherby sort etc operation ind val may good path head see yet