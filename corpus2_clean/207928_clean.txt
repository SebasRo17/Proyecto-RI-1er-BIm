practicing using immutable c personal goal representing generic graph heap sequence immutable graph building multi version graph much hard problem performance brute force versioning need full copy graph acceptable tried share unchanged node case got new problem reference reference must updated whole graph need visiting node time derive new graph version mutates node reference also derived copying performance better much brute force copying far imagine real efficient way represent mutation graph immutable state asking idea possible represent mutation graph efficiently immutable state