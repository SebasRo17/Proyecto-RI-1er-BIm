cross posted wolfram community forum found code forum apparently worked previous version mathematica run keep running age able find error ewa financialdata nyse ewa value ewc financialdata nyse ewc value data transpose ewa ewc johansenprocedure level matrixq p integer dimension level dimension level p n dimension level dimension level diff rest level rotateleft level ypt drop level p module x r rpt sop cc v log x join drop rotateleft diff p range p q inverse transpose x x drop diff p r x q transpose x rpt ypt x q transpose x ypt transpose r r p transpose r rpt cc inverse choleskydecomposition transpose rpt rpt v eigensystem cc transpose p inverse p transpose cc log log reverse foldlist plus first log rest log reverse log join reverse transpose transpose cc v p johansenprocedure data error code dot dotsh tensor incompatible shape dot dotsh tensor incompatible shape guy suggested line broken r x q transpose x rpt ypt x q transpose x ypt spent age able figure could someone give try