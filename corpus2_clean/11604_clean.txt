sorry need following code much faster running idea appreciate help post two fastest idea tab mat although really fast thanks advance clear bnum nnum weight newmat sortmat tab bnum nnum weight table randomreal b bnum n nnum newmat table randomreal b bnum n nnum sortmat table tab table sum weight k newmat k sortmat j nnum k bnum j length sortmat absolutetiming mat block k reap sow table sum weight k newmat k sortmat j nnum j length sortmat k bnum absolutetiming