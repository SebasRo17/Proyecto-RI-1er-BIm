suppose interface declaring following signature searchresults filter inside concrete implementation instantiate helper call querybuilder built ease construction strongly typed search query specific search library using want unit test ideally mocking query builder mean need decouple querybuilder appropriately two thing logically coupled say appropriate pas implementation tightly coupled implementer e type value querybuilder method specific library used concrete appropriate pas instance constructor via di directly logical scope query builder instance local call instantiated state manipulated adding sub query complete query extracted call given appropriate way handling sound like case factory however implementation factory would trivial seems little contrived define factory interface add constructor parameter sake testability indicative fundamental flaw design search interface decouple thing appropriately test search service query builder implementation isolation