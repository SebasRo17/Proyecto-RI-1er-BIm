simple immutable deque based binary tree think kind structure possibly improvement thereof seem useful could improve preferably without getting rid strength sense operation sense different design sort thing red node newly instantiated blue one reused node actually red anything emphasis note right deques take n access element deque depends long ago inserted perform enqueue concat operation num also use weight non leaf node change orientation tree make right access costly left access cheap provide logn access either end process take n worst case depending initial orientation tree alternatively could search lightest node insert given node turning operation logn operation