way operate dataset across level apply function f key value pair association follows pivotapply f key value key f key value example take titanic dataset pivot class titanicclass titanic groupby key class keydrop key class problem assume titanicclass class key deleted referenced motivation tree structured data would inefficient insert key st deeper level foo represents client function applied deeper level data depenent class value edit age foo st data dataset data age foo nd data dataset data sex foo rd data dataset data survived way avoid inefficient downcasting normal back dataset use associationmap also note datasets nested larger one also cast list since outer dataset associationmap pivotapply foo titanicclass normal dataset enter image description way query datasets across level like seems extremely roundabout figured implementation using say key value related dataset operator