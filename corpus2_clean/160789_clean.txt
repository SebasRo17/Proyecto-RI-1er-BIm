working application ip routing qos today qos implemented num priority low normal high level create queue soon package queued send forward fifo way scheduler spend num time high queue num time normal num low queue work fifo drawback like aggressive traffic fill queue flow priority stucked high usage tcp slow udp keep flooding queue mean end udp flow better tcp flow thinking way improve idea implement following algorithm keep high normal low num queue one per seen protocol scheduler still spending num time spend high queue num time normal num low queue round robin queue priority choosen queue still forward packet fifo way drawback implementation expensive cpu missing something recommendation