main confusion difference two code block end long spiel spiel contains code create polynomial coefficient helpful explaining difference thanks advance polynomial eu eu degree n n multiple inclusive solution simplify solve eu eu solution p solution select solution element real p simplify solve eu eu p real return root tell lower value n n increase point start returning slightly different root later first code block return bunch different root second one usually return one root repeated many time n increase second one repeated root seems farther away root gotten first one first one probably get true root since size solution includes complex root equal n number second one getting edit smallest n number root root slightly different first method produce whereas second produce smallest n number root different method first method produce whereas second produce edit code set polynomial follows n q n mod n q q upperbound mat array n prob array n prob array n prob array n n q prob q prob q n q q prob prob prob mat prob prob prob mat mat array n n q mat mat mat mat array n prob array n prob array n prob array n n q prob q n q q prob q prob prob prob mat prob prob prob mat mat array n n q mat mat mat u p p eu n eu eu mat u p upperbound p upperbound n eu simplify eu eu n eu eu mat u p upperbound n p upperbound eu simplify eu also note following code result solution first code block simplify solve eu eu p p complex whereas code result solution second code block simplify solve eu eu p p real something allowing function value complex v allowing complex understand function would ever complex p restricted real since coefficient real also exactly restrict function value real solving root root different case complex function value allowed sorry kind mess would really appreciate help provide