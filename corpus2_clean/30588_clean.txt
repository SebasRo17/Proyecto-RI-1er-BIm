writing function take expression input want make sure expression valid first processing looking correct use matchq better method use return true false given expression specification expression following form co x b co x b co x b sin x b sin x b sin x b parse one trick use parser using one term also amplitude also need check used argument trig function expression co co x ok first level need validated expression passed trigreduce parser need check top level form hence following valid expression return true sin x sin x sin x sin x b sin x sin x b c sin x valid sin x co x mixed sin x first term sin co sin x b sin x v function needed specification parse expr return either true false efficient way test suite help making parser expression return true another set return false clearall x b b b truetests co x co x b co x co x b co x co x b co x b sin x sin x b sin x sin x b sin x sin x b sin x b falsetests co x b sin x co x b co x co x b sin x b co x sin x