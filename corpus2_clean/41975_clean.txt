trying output efficient fortran code mathematica method simon provided get mathematica produce better fortran code expression follows v det x x x x z z z z b det z z z c det x x x z z z det x x x b det z z z c det x x x z z z det x x x b det z z z c det x x x z z z det x x x b det z z z c det x x x z z z det x x x bcdv b c b c b c b c v code produce fortran code follows experimental optimizeexpression fullsimplify bcdv optimizationsymbol tmp holdpattern experimental optimizedexpression block tempvars compoundexpression defs set expr block set tostring tostring fortranform list defs expr flatten exportstring table however produced following code number production operation tmp z tmp z tmp z tmp tmp z tmp z tmp tmp z tmp tmp tmp tmp z tmp tmp z tmp tmp z tmp tmp z tmp tmp tmp tmp z tmp tmp z tmp tmp z tmp tmp z tmp tmp z tmp tmp z tmp tmp tmp tmp tmp tmp x tmp x tmp x x tmp x tmp x tmp tmp tmp tmp tmp x tmp x tmp x x tmp x tmp x tmp tmp tmp tmp tmp x tmp x tmp x x tmp x tmp x tmp tmp tmp tmp tmp x tmp x tmp x x tmp x tmp x tmp x z x z x z x z x z x z x z x z x z z z z z z x x x x z x tmp z z z z ideal code follows number production operation x x x z z z x x x z z z x x x z z z x x x z z z b z z b z z b z z b z z c x z x z c x z x z c x z x z c x z x z x x x x x x x x v x b x b x b x b better way produce high efficient fortran code thanks tang laoya