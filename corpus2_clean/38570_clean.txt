suppose point set point labeled n p coordinate point want label nearest next nearest point maybe several corresponding every point point set example p p p p want list nearest neighbour like mean p p nearest p p nearest p etc need similar next nearest neighbour list write following code num p randominteger num coolist table p num clear position position expr positiondata sortby gatherby extract expr verbatim position expr depth expr first min length dispatch replace positiondata poscoolist position coolist clear nnsite nnsite k coolist module nncoolist nncoolist nearest complement coolist p k p k flatten table poscoolist nncoolist length nncoolist nearestlist table nnsite coolist num absolutetiming clear nnlabel thread evaluate array nnlabel num nearestlist clear nnnsite nnnsite k coolist module nnncoolist nnncoolist nearest complement delete coolist partition nnlabel k p k p k flatten table poscoolist nnncoolist length nnncoolist nextnearestlist table nnnsite coolist num absolutetiming function position code provide mr wizard see nearestlist nextnearestlist give result notice use code supply every coordinate p point point take minute point take minute quite long feel code simple must better way efficient