going write custom trial division primality test know primeq first try trial division switch powermod trialfactorfreeq n max j j max divisible n prime j false j return j max example testing k digit number first prime took second slow since real testing applied billion prime timing trialfactorfreeq true optimized wrote parallel version timing seems good wrap function timing go sky p max prime paralleltrialfactorfreeq num maxi isfree true paralleldo divisible num isfree false break prime range primepi maxi isfree abortkernels return isfree absolutetiming paralleltrialfactorfreeq p max true timing num p maxi max isfree true paralleldo divisible num isfree false break prime range primepi maxi isfree abortkernels isfree true updated based daniel lichtblau answer fast sieve implementation question wrote fast trial division function used number larger product prime given range prod product prime range trialfactorfreeq n gcd n prod x speedup n timing trialfactorfreeq n true