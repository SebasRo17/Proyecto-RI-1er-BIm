architecture consists front end cache read user obtain directly front end cache sits front farm webservers serve page written php need able detect certain condition front end cache level pas value back end via http header example would like manually tag carrier network based ip address incoming traffic user say coming ip address range num num num would tag orange user setting appropriate http request header e g x carrier orange based setting header would like vary cache serve different banner end user would go keep mind want pollute cache also want create many small cache segment assumption assume x carrier already detected cache purpose test set manually example script