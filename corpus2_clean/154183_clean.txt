typically c use dependency injection help mocking public userservice public userservice userquery userquery userquery public userid username var result validateusername username result success var user userquery getuserbyid userid user throw new argumentexception user username username updateuser user public public var userquery substitute userquery getuserbyid arg return var userservice new userservice userquery argumentexception userservice getuserbyid num something like f go hybrid path would test workflow situation like normally would touch persistence layer without using interface mock realize every step would tested would kept atomic possible problem point called want make sure everything called correctly