interplanetary trajectory solver calculates spacecraft route earth mar trying zoom spacecraft reach mar intercept orbit trouble originally asked question similar nature forum zooming animated plot used simple parametric function example although given good answer unable translate solution trajectory solver bit involved stripped version code show orbit earth inner circle mar outer circle spacecraft line joining inner outer circle although tried worked look plotrange code used making trajectory animation used function change plotrange essentially zoom spacecraft got close mar unfortunately code work left essentially want pseudo code help would appreciated thanks guy remove global gravitational constant g simulation running time tmax spacecraft tof earth mar dt time mid course correction applied dtmcc dt mass sun earth mar spacecraft mass sun mass earth mass mar planetary radius sun earth mar r mean radius sun r mean radius earth r mean radius mar heliocentric position earth mar november p p p heliocentric velocity earth mar november v v vlambert vlambert mindr theta v x v soln ndsolve x g x x g x x g x x g x x g x x g x x x x g x x x x g x g x x g x x x p p x p p x p p x v v x v v x v v whenevent dtmcc x vlambert vlambert whenevent x v x sqrt g mindr sin theta v sqrt g mindr co theta x x x tmax startingstepsize accuracygoal precisiongoal method stiffnessswitching maxsteps orbit parametricplot x x x soln tmax axeslabel x imagesize large plotrange orbitanimation animate parametricplot x x x soln axeslabel x imagesize large plotrange x x tmax animationrate enter image description