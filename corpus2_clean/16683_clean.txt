following code solves problem example given u follows lst predicate positive maximal predicate segment lst getsegments lst predicate module re seg lstcopy lst length lstcopy seg takewhile lstcopy predicate length seg true appendto re seg lstcopy drop lstcopy length seg false lstcopy drop lstcopy length takewhile lstcopy predicate return re code work fine following input getsegments randominteger positive getsegments randominteger negative yet something strange happens following getsegments randominteger evenq getsegments evenq oddq treat randominteger result differently list input also generated call randominteger find seg always empty case false branch take element list edit note run mathematica linux work fine window version mathematica edit getsegments randominteger evenq trace randominteger getsegments evenq splitby evenq evenq first splitby evenq split evenq evenq evenq evenq evenq evenq evenq false evenq true false true false evenq evenq evenq evenq evenq true evenq false true false false evenq evenq evenq evenq evenq false evenq true false true false evenq evenq evenq evenq evenq true evenq false true false false first evenq false false trimmed problem following lst randominteger takewhile lst evenq takewhile lst oddq one takewhile call always return value yet give empty list work fine window yet fails linux