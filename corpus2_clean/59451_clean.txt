standard function diagonalmatrix cannot compiled tried writing diagmat compile vec real module size length vec matr matr table size size matr vec size matr function work compile check export test c diagmat simpler way give error message ccodegenerate wmreq expression function vec icompile matrcompile block icompile matr matrcompile matr vec matr requires mathematica evaluated function generated expected fail nonzero error code executed sure wrong function use compilable thanks