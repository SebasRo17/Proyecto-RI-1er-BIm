example entity domain layer account def init author self self email email repository interface domain layer accountrepository def add self account account account pas def find self pas def find email self email pas remove others domain service domain layer signupservice def init self account repository account repository accountrepository self account repository account repository def create account self username email account account username email self account repository add account method us account repository repository strategy implementation infrastructure layer mongodbaccountrepository accountrepository def init self mongodb database self mongodb database mongodb database def add self account account account dict self mongodb database account insert account method functional test mongodbaccountrepository testing add directly querying mongodb check persisted suppose unit test signupservice mocking accountrepository pro quickly con really suppose infrastructure work fine domain service work fine mock real integration work fine introducing bug mock test pass failing b functional test signupservice using real mongodbaccountrepository pro sure signupservice really work fine con many test strategy etc slow think