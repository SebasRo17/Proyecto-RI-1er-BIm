given sphere radius centered origin n sphere radius r centered predefined coordinate c space surface area unit sphere intersected surrounding sphere e g given coordinate c interested potentially visible blue surface area graphic generated blue sphere red sphere c graphic principle obtain area evaluating following integral fun function p evaluate time unitstep total sin co p sin sin p co c nintegrate evaluate fun p sin pi p pi absolutetiming however approach slow particular large number sphere convergence issue attempt speed integral evaluation devised following code snippet based naive non adaptive application trapezoidal rule n theta n pi n range n phi n pi n range n int constantarray n int int constantarray n int calculating ptst slow however could pre calculated ptst transpose outer sin co sin sin co theta phi lv transpose fold unitstep total ptst constantarray n n c int lv int sin theta pi n pi n absolutetiming calculation sped also interested increasing number surrounding sphere approximately following code snippet generate n sphere might useful comparing performance different approach coords n transpose table n phi pi sqrt co phi sin phi sqrt n constantarray n