trying determine reaction function cournot equilibrium n firm using optimal condition using fixed point method method using fixedpoint g x x tol nmax module g sol oldsol iter n vector g x must length n length x g g table x n infnorm max ab sol x oldsol sol tol iter iter nmax infnorm sol oldsol tol oldsol sol sol g sol iter print performed iter iteration iter nmax print warning maximum number iteration reached sol equilibrium condition derivative profit respect quantity qt eta eta qt eta qi ai q eta ai parameter qt sum quantity produced n firm qi quantity produced single firm problem determining g argument method n firm generate n optimal function assuming corresponding value ai qi