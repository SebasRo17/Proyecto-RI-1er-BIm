rule writing break section subsection typically one subsection go back old high school composition rule section also need b section check chapter book writing latex egrep h chapter sub section tex sed e g chapter chapter section topic subsection subsection another subsection third section subsection subsection less section subsection marge homer bart lisa subsection example section section efficient algorithm verify rule obeyed rule go sub section section section subsection though case section thanks bart advice created hacky place simple found bug latex file usr bin env import sys import fileinput token chapter num section num subsection num num num def report level number subsection token level token startswith token level raise exception def store lst level store level th position len lst level lst append empty lst level def segment read text yield list segment path last level num fileinput index num index path store path yield path def get tree build tree segment list returned generator tree tree setdefault tree def audit audit leaf ok node ok num child k v item audit v len v num part one subpart k def tree get tree segment audit tree num sys exit