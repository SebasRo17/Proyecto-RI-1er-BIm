want implement bulk ferromagnetic hysteresis model mostly jiles atherton model see page equation needed equation delta text sgn dot h ex h text eff h alpha ex text h text eff text sat cdot mathcal l h text eff ex delta text begin case dot h text text dot h text text text else end case main equation frac text text h frac frac k delta c mu frac text text text h text eff delta text text frac k delta mu delta text text alpha frac k delta alpha c mu frac text text text h text eff short explanation delta take account wheter upper hysteresis branch lower one h text eff needed shift langevinfunction mathcal l x achieve hysteresis text anhysteretic magnetization delta text necessary prevent unphysical behaviour tried implement two approach tried first one based parametricndsolve understand value need go h text max problem work h text max h text max part unsure achieve first guess define function piecewise implemented shift beware monster ugly function micro pi bulkferromagnetichysteresismodelcomplete parametricndsolvevalue mges happlied piecewise k c micro msat happlied alpha mges happlied csch happlied alpha mges happlied piecewise msat piecewise ab coth true happlied alpha mges happlied mges happlied true msat piecewise ab coth true happlied alpha mges happlied mges happlied k micro piecewise msat piecewise ab coth true happlied alpha mges happlied mges happlied true msat piecewise ab coth true happlied alpha mges happlied mges happlied alpha k c alpha micro msat happlied alpha mges happlied csch happlied alpha mges happlied happlied k c micro msat happlied alpha mges happlied csch happlied alpha mges happlied piecewise msat piecewise ab coth true happlied alpha mges happlied mges happlied true msat piecewise ab coth true happlied alpha mges happlied mges happlied k micro piecewise msat piecewise ab coth true happlied alpha mges happlied mges happlied true msat piecewise ab coth true happlied alpha mges happlied mges happlied alpha k c alpha micro msat happlied alpha mges happlied csch happlied alpha mges happlied happlied k c micro msat happlied alpha mges happlied csch happlied alpha mges happlied piecewise msat piecewise ab coth true happlied alpha mges happlied mges happlied true msat piecewise ab coth true happlied alpha mges happlied mges happlied k micro piecewise msat piecewise ab coth true happlied alpha mges happlied mges happlied true msat piecewise ab coth true happlied alpha mges happlied mges happlied alpha k c alpha micro msat happlied alpha mges happlied csch happlied alpha mges happlied happlied mges mges happlied msat k alpha c unfortunately work suspect mges happlied respectively mges happlied yes workauround edit precise compiling shown work proceeding modelcomplete msat k alpha c happlied bulkferromagnetichysteresismodelcomplete msat k alpha c happlied list numericq msat k alpha c happlied lead several second look already done time compiling error mathematica kernel window stopped working problem event name appcrash application name mathkernel exe fault module name mathdll dll another possible approach described computer aided analysis electric machine mathematica approach vlado ostovic book early code presented work main idea use periodic function achieve hyteresis effect seems got virgin curve working well m kon alpha mu n pi c hmax omega n pi eq mges m coth hmax co pi alpha mges hmax co pi alpha mges mges c kon mu alpha m coth alpha mges hmax co pi alpha mges mges c c m hmax co pi alpha mges csch hmax co pi alpha mges mges test ndsolve eq mges plot evaluate mges test plotrange instead mges would necessary use mges hmax co pi sadly mathematica crash try use expression edit precise use mges hmax co pi throughout eq get following error ndsolve derivs derivative dependent variable found equation ndsolve designed solve differential differential algebraic equation use nsolve findroot numerically solve algebraic equation suspect due mathematica recognizing mges hmax co pi x f x anyone idea overcome obstacle thanks lot advance really appreciate help