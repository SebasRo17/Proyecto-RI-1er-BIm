elasticsearch search engine internal web application prior applying security model search result fast security model restricts user accessing certain page num type page process currently num search engine query record num result get database user allowed access ensures call database max num time per num intersect record user access record search returning approach fast enough search query take num second typical way make search engine result adhere security another developer recommended store security permission directly elasticsearch essentially mirroring sql server edit record page assume num num user num record