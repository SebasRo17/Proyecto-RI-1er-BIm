completely new programming apologize advance stupid question want program algorithm computing invariant factor finitely generated abelian group essence want feed algorithm matrix relation get reduced form matrix compiled cumbersome code make first step procedure namely take matrix produce matrix upper left element divide element first row first columm freeq print first dimension l sparsearray nonzeropositions first first l j part first l j j normal sparsearray first dimension table first dimension first dimension boole divisible table first dimension first dimension divisible normal sparsearray quotient first dimension first dimension boole divisible matrix give want iterate procedure want feed arbitrary matrix code function got stuck problem several hour hope could help solve thank