challenge given n point mathbf r cutoff distance would like determine pair point separated less given cutoff distance pair point connected less segment taken list pair straight forward small n large n simplistic approach given slow searching pair memory consuming graphdistancematrix seems return dense matrix could problem solved efficiently n order inefficient sample code generate sample data n desired n po randomreal n n find close point ad connected select subset range n norm po po pair point closer leap apart ad v union flatten connected g graph v undirectededge connected gdm graphdistancematrix g ind select position gdm alternative thread range length v v