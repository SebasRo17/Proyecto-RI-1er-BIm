wondering architecture pattern choose following problem divided three step num import description file e g xl txt num process described num export description processed result xml got far importer read xl creates hierarchical structure parser creates abstract syntax tree else end command structure processor visitorpattern ast processor instantiates command implementation executes command collect result control flow else currently imported structure already contains field result serialized xml opinion elegant result field object reason like reuse imported structure order process multiple time would like divide whole component also three part num import creates hierarchical structure describes containing fileparser preprocessor num process creates ast process num export take result description writes condition every ast node represents structure description result connected description description result hierarchical