trying write function solve tridiagonal system linear equation using thomas algorithm basically solves following equation detail found wiki page tridiagonal matrix algorithm begin bmatrix b c b c b ddots ddots ddots c n n b n end bmatrix cdot begin bmatrix x x x vdots x n end bmatrix begin bmatrix vdots n end bmatrix done easily various way mathematica using built function solve linearsolve ludecomposition etc instead using mathematica wonderful black box solver decided follow procedure algorithm write version better control procedure detail c begin case begin array lcl cfrac c b cfrac c b c dot n end array end case begin case begin array lcl cfrac b cfrac b c dot n end array end case begin array lcl x n n x c ix end array tried write function mathematica like tridag b c module n length c range length range length x range length c c b c c c c b c c c n x n n x c x n x b c three diagonal row matrix test case r function give answer mathematica linear solver linearsolve r tridag padleft diagonal diagonal padright diagonal r question since novice function simply direct translation procedurual equation would like learn really functional mathematica way implementing function using built solver general question given algorithm written procedure way e implementation procedure language like c fortran mind translated functional mathematica code give example suggestion guideline edit belisarius point real elegant mathematica way always use already implemented function clear asking implement solver superior built solver asking implement solver mathematica way e functional way think knowing write one solver helpful using built solver give user confidence built solver work example may hilbertmatrix linearsolve hilbertmatrix table random linearsolve luc result linearsolve badly conditioned matrix may contain significant numerical error besides think trying implement simple solver good way new hand learn mathematica language