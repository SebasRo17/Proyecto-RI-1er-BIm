writing function sum pairwise potential two list e two charged body containing n atom respectively need able calculate potential atom atom residue residue body body potential order defined atom atom residue residue body body potential caa atom atom coulomb atom atom crr re re total outer caa re re cbb body body total outer crr body body body re re re body re re re re atom atom atom re atom atom atom re atom atom atom re atom atom atom atom x z q atom x z q atom x z q atom x z q e two list body residue turn list atom properly indexed question efficient way define crr cbb tried loop sum table total outer definition shown seem take almost long time timing check needless say coulomb radial function e depends distance atom atom atom x z q q charge edit coulomb atom atom atom atom norm atom atom edit find small example body body body give ith residue first body body j jth atom ith residue body atom atom potential calculated caa body j body k l residue residue potential crr body body j body body potential cbb body body hope clarifies problem