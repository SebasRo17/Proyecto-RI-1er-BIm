web application support multi tenancy keep customer separate connection pool customer database created runtime detail customer shard jdbc url credential etc stored shard control database application need access customer shard try obtain jdbc connection shard connection pool connection pool established yet application look necessary detail control schema creates pool fine setup one major issue sure best solve application eventually going clustered app instance managing customer shard connection pool problem location customer shard change happen often happen application admin interface managing shard detail could put say rebuild shard connection pool would interacting whichever application instance load balancer sent request instance would aware wanted pool rebuilt way think deal along pro con see num since scenario frequent occurrence restart application cluster instance situation arises call day pro requires work con workaround solution said restarting app instance cluster might easy pushing button going coffee break additionally application user permission manage customer shard might someone allowed initiate cluster restart num releasing connection connection pool check control database see pool definition changed reconfigure pool releasing connection whomever requested pro straight forward approach application instance guaranteed get connection right shard using information con major performance overhead need hit control schema read shard definition compare currently got loaded every single connection request application num background thread timer look shard definition change rebuilds pool necessary pro avoid performance hit involved check upon every request connection con shard definition changed going period time application instance wrong information lot consequence including application exception shard definition change picked longer check interval worse problem going like short possible shorter bigger performance hit need load shard definition control database num wait exception thrown trying obtain connection shard connection pool take opportunity hit control schema see shard definition changed pro none performance problem option num num con assumes changing shard definition old location longer functioning may alone think reason enough kill option listing came mind num create shard definition change topic messaging infrastructure application instance would subscribed reload connection pool response pro none performance issue option num num none stale issue option num con messaging infrastructure available today coming nothing put date yet appreciate thought experience advice share problem