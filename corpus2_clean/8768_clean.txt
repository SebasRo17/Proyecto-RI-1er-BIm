used numerical simulation mathematica idea improve e speed code f numericq b numericq c numericq delta numericq k numericq numericq module kk kk sigma beta rho kk ndsolve xt yt xt yt xt zt yt zt xt yt zt xt yt zt xt yt zt sigma rho beta kk ndsolve join table x sigma x sum x j x j table x rho z b sum j j table z x beta z c sum z j z j table x table table z join table x table table z outt tt xt tt yt tt zt tt kk ti table k tt sum x tt sum tt sum z tt kk dist tt tt outt tt tt outt tt tt outt tt tt fc k delta sum nintegrate dist tt tt ti ti delta k fc f absolutetiming thanks lot