bottleneck problem involving function call symbolic derivative much experience mathematica dynamic language certain way set basic get anyone mathematica fluent probably spot several obvious change speed thing please tell probably host rtfm suggestion speeding call function welcome specific suggestion would great quantity mainterm l r theta phi factora factorb get called many time nested loop r theta phi coordinate l iteration involves calling spherical harmonic hankel function calculating derivative double derivative ad nauseum expanded derivative double derivative level hypergeometric basis function avoid calculus fly seemed slow thing baffled block shown mainly illustrate complexity function need compute e hoping advice compile otherwise speed function analytic derivative might need calculated fly quantitative absolutetiming comparison k somevalue preaaa factora sphericalhankelh l k r sphericalharmonicy l theta phi theta sin theta theta sphericalhankelh l k r sphericalharmonicy l theta phi phi aaa expand preradial bbb factorb sphericalhankelh l k r sphericalharmonicy l theta phi phi factora sphericalharmonicy l theta phi theta r sphericalhankelh l k r r ccc factorb sphericalhankelh l k r sphericalharmonicy l theta phi theta factora sphericalharmonicy l theta phi phi r sphericalhankelh l k r r mainterm l r theta phi factora factorb aaa bbb ccc subequently inside l loop set storevalue l mainterm l compile aaa bbb ccc individually set storevalue way code run slower confused aware compiling component term could speed thing tried various approach end without compiling c without explicitly defining real integer etc none much effect slowed thing suggestion better set large number nested function call