given set partial order prec looking way efficiently generate list linear extension prec suppose partial order given list pair x x example b c c b c defines partial order prec c b prec c essentially given list list pair p want generate list permutation respect order pair p linearextensions b c e b c b c e c b e c e b c e b e c b e c b c b e c e b c e b c e b c e b c e b e c b e c b e c b e c b e c b since b p permutation b c e linear extension b come written two different function job using pattern matching using mathematica less week still getting functional mindset interested see seasoned mathematica user would tackle problem first approach use nestwhile edit ugly know fold function wrote linearextensions set po module pattern pattern po first nestwhile case first rest permutation set pattern length second approach turned significantly slower expand set rule partial order use select list permutation linearextensions set po module poq poq rule matchq rule po select permutation set poq note list length n omega n linear extension efficient mean polynomial time