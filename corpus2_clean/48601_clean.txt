trying create multiplicative partition function would generate something like f f f got far n factorinteger n r range length join f flatten map table x r transpose deleteduplicates f map n range length turning complicated thought efficient way tackling update got little still missing n factorinteger n r range length f flatten map table x r p drop drop deleteduplicates subset f split drop drop reverse divisor n drop map sort join p range length