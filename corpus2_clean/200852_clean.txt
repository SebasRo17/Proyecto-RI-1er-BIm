process developing scalable proxy linux c c nginx module custom http server handling incoming http request routing others location based parameter included incoming request ip time example external factor hence use nginx module able retrieve external factor however tricky part regarding quota example wish could block proxying request originating ip daily allowance quota implementing quota hard however quota work distributed environment ideally everything shared nothing far trivial indeed quota state must shared distributed process know whether proceed central quota handler mean using lock make think performance drop quickly locking quota status every time proxying request handled look like solution hint