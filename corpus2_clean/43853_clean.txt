mathematica function powermod b computes b mod concern case b power prime say p n b result powermod number mod e inverse mod standard way compute inverse prime power give code idea use newton method p adic sense padicinverse n integer p integer n integer module stepmax x stepmax floor log n mod n p n mod p x powermod p x mod x x p stepmax x mod x p n primeq p n give correct answer build powermod p n x faster code would like know speed thought use something like nest fold figure reason step work different modulo p course use modulo p n time much slower even use nest really important wonder speed