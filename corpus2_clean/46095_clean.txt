use function f module f module f work fine give error use compile follows demand n k qr min k vf n capacity qr supply n k qr min n kj k w n capacity qr nsupply n k qsum qrsum qr min n kj k vf qsum qrsum n capacity qr floexct n ku k qsum qrsum qr min demand n ku qr nsupply n k qsum qrsum qr gamma ku kd min supply l kd demand l ku inflow phi qin phi beta qin dx density qin qout qr qin qout qr vf kj w vf capacity n p rml alpha beta l delta dt dx f compile integer integer integer module k constantarray n fk table table n j kr table table p n rk table table table p n phi fq table table n j qin fin table table n j qr rq table table table p n rmori table n rm table n tt qf qsum qrsum rmori table dx dx n kr replacepart alpha delta vf kr appendto rk kr phi demand kr mapthread gamma take k take k qsum n plus fq qrsum join plus fin qf mapthread floexct l k rest fk qsum qrsum join phi qin inflow phi qf k join density qf rest qf qin qsum mapthread plus rq rm mapthread min rmori mapthread floexct rml rml rml kr rk qsum qr mapthread join mapthread floexct take rml kr take rml rk take rml qsum rm mapthread floexct take rml kr take rml rk take rml qsum phi kr mapthread join density rest qr kr tt plus k tt plus plus kr fq delete fq fin delete fin rq delete rq fk delete fk rk delete rk appendto fq qf appendto fin qin appendto rq qr appendto fk k appendto rk kr tt error shown related qsum variable someone tell missing mapthread list list expected position mapthread plus compile functionvariable compile cprank compile cannot determine rank result tensor length compile functionvariable mapthread plus compile functionvariable unknown compiling time evaluation use uncompiled function compile cset variable qsum type real encountered assignment type integer compile part part specification compile getelement qsum compile variable cannot compiled since argument tensor sufficient rank evaluation use uncompiled function compile part part specification compile getelement qsum compile variable cannot compiled since argument tensor sufficient rank evaluation use uncompiled function compile part part specification compile getelement qsum compile variable cannot compiled since argument tensor sufficient rank evaluation use uncompiled function general stop output compile part suppressed calculation compile cplist compile getelement qsum system private compilesymbol tensor type integer real complex evaluation use uncompiled function compile cplist compile getelement qsum system private compilesymbol tensor type integer real complex evaluation use uncompiled function compile cplist compile getelement qsum system private compilesymbol tensor type integer real complex evaluation use uncompiled function general stop output compile cplist suppressed calculation mapthread list list expected position mapthread plus compile functionvariable compile cprank compile cannot determine rank result tensor length compile functionvariable mapthread plus compile functionvariable unknown compiling time evaluation use uncompiled function compile cset variable qsum type real encountered assignment type integer edit please note code simplified partial piece larger code presented show problem area original code several hundred iteration till condition met critical step compiled function called several thousand time direct search based optimization edit thanks xzczd following code compiles without error however give error warning run time code may look cumbersome problem area specific f kj w vf capacity n p rml alpha beta l delta dt dx module demand supply nsupply floexct gamma inflow density demand min vf capacity supply min kj w capacity nsupply min kj vf capacity floexct evaluate min demand nsupply gamma evaluate min supply l demand l inflow beta dx density vf compile integer integer integer module k table n fk table n kr table n p rk table n p fq table n fin table n rq table n p rmori table dx dx n shutoff false j phi qin qr qf qsum qrsum rm tt ntwrktt min rmori max rmori print mr within bound ntwrktt kr replacepart alpha delta vf kr ntwrktt tt total total kr appendto rk kr tt tt phi demand kr mapthread gamma take k take k qrsum join total fin qf mapthread floexct l k rest fk total fq qrsum join phi qin inflow phi qf k join density qf rest qf qin qsum total rq rm mapthread min rmori mapthread floexct rml rml rml kr rk qsum qr mapthread join mapthread floexct take rml kr take rml rk take rml qsum rm mapthread floexct take rml kr take rml rk take rml qsum phi kr mapthread join density rest qr kr tt total k tt total total kr ntwrktt tt j fq delete fq fin delete fin rq delete rq fk delete fk rk delete rk appendto fq qf appendto fin qin appendto rq qr appendto fk k appendto rk kr print j j kj alpha w print ramp spillback ntwrktt break kr shutoff false j shutoff true kr replacepart kr ntwrktt dt compilationoptions inlineexternaldefinitions true run compiled function f run loop give following error compiledfunction cfse compiled expression null null null null null null null null null null null null null machine size real number compiledfunction cfex could complete external evaluation instruction proceeding uncompiled evaluation proceeds run program guess uncompiled fashion one possible variable refers null null null null null null null null null null null null null may rm wondering source problem