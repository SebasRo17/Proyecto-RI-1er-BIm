need evaluate derivative function function look like approx vector x sum vector n basis n x n length vector defining derivative like ddappx vector x approx vector x x however evaluate specific x get error general ivar valid variable searched enough know solution plotting evaluate first something holdall need use set simultaneous equation able solve ddappx b ddappx b b solve b setting nd derivative approx x x however get general ivar valid variable error evaluating like solve evaluate ddappx b evaluate ddappx b b working idea cheer edit made suggested change error solved however although evaluating approx work perfectly well evaluating ddappx give matter error added whole code go front case think relevant diffeq x x x f x co x basis n x chebyshevt n x approx vector x sum vector n basis n x n length vector ddappx vector x derivative approx vector x approx x return correctly x x x ddappx x return incorrectly