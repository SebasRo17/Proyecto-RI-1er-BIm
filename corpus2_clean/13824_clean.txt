need perform computation modulo ring like mod subfactorial n mod binomial n k however obviously much slow large n k mathematica offer possibility perform computation faster using efficient algorithm compute modulo example andrew granville generalization lucas theorem would compute binomial coefficient much faster like implement want use mathematica cross check result another program mine