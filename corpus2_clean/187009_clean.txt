writing simple chess related intention write clearly performance matter look clean public static piece square direction direction todo rework mess switch direction case direction top piece p p square orderby p p square first p p square case direction bottom piece p p square orderbydescending p p square first p p square case direction right case direction piece p p square orderbydescending p p square x first p p square x x default throw new store piece list using linq find piece closest given square given direction num switch statement size num case total always present smell num way refactor part consider reviewing design whole solution