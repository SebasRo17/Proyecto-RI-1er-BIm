trying write simple program perform f long smaller declared list problem easy difficult explain give code f x x nestwhile f rule rule f replaceall rep f slot neither list replacement rule valid dispatch table cannot used replacing calculation step want change replacement rule list desired output idea make work know sound like stupid example fix also fix problem original function