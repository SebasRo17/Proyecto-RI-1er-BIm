imagine following problem population size n consists men n woman population go casino call g g w amount money men woman respectively event men win j dollar woman k dollar occurs probability p jk probability constant number possible value g g w equal q finite visit casino constitutes multinational trial want determine distribution money men woman x casino visit strategy following define multinational distribution multinomialdistribution x pjk q pair g g w probability higher zero take integer partition number attempt x assume integerspartition size h add q h zero obtain vector size q find permutation vector routine find possible realization x visit p integerpartitions k k length p k vec join vector permutation join p k constantarray j length p k let g g g w vector possible outcome casino visit define function visit find probability sum gained money men woman visit c module join total c g pdf c finally gather entry obtained distribution represent outcome summing respective probability sumd flatten total gatherby map visit vec problem approach size g relatively high around number visit x size array permutation exceeds way get around possible example write permutation directly file instead storing array