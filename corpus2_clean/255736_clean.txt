looking idea efficiently solve following problem set pair range range pair number range unique size e g num num num num num num num num num num num num num num num num num num num num num num num num like combine pair range range overlapping e g num num num num overlap num num num num result num num num num result set like get pair may range different size num num num num num num num num num num num num set might pretty big like avoid quadratic complexity possible edit best idea far like know know better faster way also sure idea removing already combined pair valid def range overlap num num num num def combine pair min r1 num r2 num max r1 num r2 num r1 r2 zip def combine overlapping pair pair combined pair pair pop already combined pair perm itertools permutation overlap zip perm range overlap overlap break overlap combine pair perm already combined append break combined append sure pair already combined pair remove pair combined