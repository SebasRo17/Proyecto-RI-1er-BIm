eventlocator option compatible lsoda ndsolve tried arrest simulation time step went certain value based suggestion script file alsoattached error message get go use eventlocator lsoda reason equation turn stiff last half time step extremely small slow unnecessary ndsolve moptx method option method ndsolve lsoda maxdifferenceorder method eventlocator event stepsize one linearsolvemethod maxdifferenceorder ndsolve initf initialization method ndsolve lsoda failed usr local bin mathematicascript script historylength pwf inputfilename need vectoranalysis need differentialequations interpolatingfunctionanatomy clear eq evapthickfilm h bo epsilon k delta bi r eq h bo epsilon k delta bi r subscriptbox partiald h div h bo grad h h grad laplacian h delta h bi h k grad h h k bi h grad h epsilon bi h k r h k bi h x h x setcoordinates cartesian x z evapthickfilm bo epsilon k delta bi r eq h x bo epsilon k delta bi r traditionalform evapthickfilm bo epsilon k delta bi r l tmax ndsolve mxsst clear kvar kvar piecewise ktemp array hsol h ndsolve bo epsilon k delta bi r evapthickfilm h h l h x h x l h x co x sin h x co pi x l sin pi x l co pi l h x l l tmax stepmonitor laststep thisstep thisstep stepsize thisstep laststep method lsoda maxdifferenceorder method eventlocator event stepsize maxstepfraction precisiongoal tmin trup interpolatingfunctiondomain hsol hsolgriddata interpolatingfunctionvaluesongrid hsol hsolcoords interpolatingfunctioncoordinates hsol finalstep interpolatingfunctioncoordinates hsol rupture numberform n trup rupture trup parameterfile stringjoin pwf dat export parameterfile setprecision rupture matfile stringjoin pwf mat export matfile hsolgriddata export time step data timefile stringjoin pwf time mat export timefile interpolatingfunctioncoordinates hsol hgrid interpolatingfunctiongrid hsol tmin trup interpolatingfunctiondomain hsol length hgrid nx ny nt drop dimension hgrid fac epsfile stringjoin pwf eps pngfile stringjoin pwf png epsfilerup stringjoin pwf trup eps pngfilerup stringjoin pwf trup png ic plot hsol x trup x l l plotrange l l basestyle fontweight plain fontsize plotpoints colorfunction graylevel export epsfile ic imagesize export pngfile ic imageresolution rupprofile plot hsol x fac trup x l l plotrange l l basestyle fontweight plain fontsize plotpoints colorfunction graylevel export epsfilerup rupprofile imagesize export pngfilerup rupprofile imageresolution dataxy import matfile datat import timefile epsfile stringjoin pwf dft eps pngfile stringjoin pwf dft png epsfilerup stringjoin pwf trup dft eps pngfilerup stringjoin pwf trup dft png fdatafirst ab fourier dataxy dftfirst matrixplot fdatafirst