trying solve aparently simple problem given list length n b c want perform two simple operation form new list one b c b c b c b c list element must greater less certain value addition substraction b c b c b c element must constrained max b b max c etc using list finally use original list n new list get list form join list new join list new solve problem wrote code although work take long time calculate several set list b c b c post example using list two sublists four element one lst dim partition range length first lst list li save composed list lst lst partition lst lst mapthread transpose lst lst union mapthread replacepart lst dim lst lst mapthread transpose lst lst union mapthread replacepart lst dim lst lst join lst lst lst join lst lst lst union join lst lst list li list lst lst list list flatten list advice improve performance code would greatly appreciated edit based comment tried explain better second part problem giving numerical example edit added precise description constraint element list