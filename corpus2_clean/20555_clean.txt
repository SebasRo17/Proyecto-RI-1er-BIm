following answer post trying implement something similar gbm stay inside corridor l u predefined time return otherwise wrote following code mc x ti per l u r n prob module data data data value j data randomfunction geometricbrownianmotionprocess r x ti length ti per n value j j n j data table select ti ti per data path j length ti data flatten data value max table data length data u min table data length data l n n value mc prob gbm stay inside time value otherwise code work really slow instance simulation take minute way improve also want calculate probability gbm breach corridor two discrete simulation example mathbb p x x l u prob cdots mathbb p want set value short looking way apply certain function prob every simulated value inside corridor way without loop someone give hint efficient way thank answer yes trying price corridor option function prob mentioned account penetration probability want get value option corridor period one visualize mean consider slightly altered plot provided module r sigma l u capitaldelta ntimes npaths seed drift diff time path containedpaths pathtoline seedrandom seed time range capitaldelta pathtoline path line transpose time path drift diff exp r sigma capitaldelta diff sigma sqrt capitaldelta path table gbmpathcompiled drift diff ntimes npaths containedpaths select path max u min l graphic pathtoline path red line l l line l l line u u line u u ax automatic aspectratio corridor active certain time per starting time per length period example would ti per