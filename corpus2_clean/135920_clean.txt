recently started write test fairly large php base using phpunit writing unit integration test model controller concensus setting boolean toggle state whether test mode alters behaviour ie email helper need send email test testing mail server called self test mode already going idea think adding extra check throughout codebase testing elegant solution example instance would good way check email sent