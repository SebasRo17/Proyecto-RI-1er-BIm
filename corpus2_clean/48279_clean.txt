partial differential equation ndsolve conservative construction int p z dz tmax sol ndsolve derivative p z derivative p z p z z exp z derivative p derivative p p tmax z precisiongoal accuracygoal order check conservation find percent difference int p z dz int p z dz timepoints value repeated call nintegrate timepoints dt tmax timepoints int p z sol nintegrate z flatten intpercentdif table p dt z sol nintegrate z flatten int int first dt timepoints listplot intpercentdif axeslabel time integral percent difference plot show error remains small case method quite computationally demanding real problem complex set coupled pdes check take long time like check every time simulate system check take longer simulation better way check conservation