large network atom approx atom fixed position resemble cellular structure enter image description two file including fixed location atom set point make cell first one like second dataset approx time row size row different example need find set exactly two element common two cell share edge word neighbor already code inefficient compare set line line code n number row parallelevaluate file openwrite rn tostring kernelid dat paralleldo writestring file flatten last reap length intersection ring ring j sow j j n n n parallelevaluate close file find intersection length specific set ring set equal two write set number file anyway improve efficiency code update alternative solution without using intersection one loop follows ring readlist ring dat number recordlists true parallelevaluate file openwrite rn tostring kernelid dat paralleldo rn complement first tally flatten first position ring ring writestring file rn n n parallelevaluate close file seems much better previous one