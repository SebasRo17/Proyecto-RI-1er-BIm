calculation superconductivity really need speed way calculate one array put input matrix course tiny toy model case somebody want time important part part asking help delta lower part input matrix nn nband nstates nn nband eigenvectors table range nstates nstates inverseflatten l dimension fold partition flatten l reverse dimension uv inverseflatten eigenvectors nstates nband nn u uv nstates nband v uv nstates nband f range nstates v table j l nband nband nband q nband nn j nn first naively started intuitive way turned crazily slow delta table table j sum v q j sum u n q v n j f n n nstates q nband nband nn j nn nband nband thanks forum learned one avoid sum smarter dot product array use total wrote delta table total flatten v table table j f u q conjugate v j nn j nn q nband nband nband nband still toooo slow bright mind forum see faster way compute delta somebody want time using timing make bigger increasing nn nband real calculation nn go nband care null element need non null element thanks