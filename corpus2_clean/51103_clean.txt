want solve ode using undetermined coefficient guess verify looking elegant way use technique running ugly wart basic implementation simple example ode r v z exp z g v z v z guess v z exp z b exp c z b c inelegance substitute guess ode directly example ode guess work guessderivs union guess v z v z guess z v z v z guess z z ugly complete substitute odesub ode guessderivs fullsimplify e z g r b e c z c g r inelegance easy example standard way get equation solve z solvealways odesub z work manually work course sub first solve g r c sub solve c g r c c last constant b would come initial value mine v example summarize ugly make guess substitution functional form derivative work e v z v z exp b z actually substitute derivative recognize problem fullform v z derivative v z rule match nice way replace generally get system equation general undetermined coefficient thought solvealways supposed edit look like cleanest method riemannzeta give list linearly independent basis vector anonymous described belisarius substitute find coefficient setup let give following goal generic undeterminedcoefficientssystem function ode r v z exp z g v z v z ic v equation union ode ic reality trying system equation v basis exp exp addition test coefficientsystem undeterminedcoefficientsystem v v basis equation assume function generates list coefficient form c c entire basis substitute set equation coefficientsystem c g c r c c c g c r c c c r c c c c last equation come v basically function following argument take list function name list basis anonymous function need use solve complicated system ode index function j take function index j basis length anonymous function generate list coefficient c j function basis create guess anonymous function linear combination c j coefficient create substitution rule given function name linear combination basis given equation substitute concatenated list guess j basis equation find coefficient riemannzeta technique append whole list different basis different function reasonable look coefficient union anoymous basis return whole list equation make sense generic function work sort functional equation ode getting stuck early example need anonymous guess ensure take derivative evaluate initial value v take two anonymous function concatenate linear combination form new one