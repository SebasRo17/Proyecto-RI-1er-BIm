writing roughly analogous cancellationtoken except third state never going cancelled moment trying decide source token garbage collected without ever set seems intuitively source transition associated token never cancelled state collected however could trigger callback kept alive linkage token mean callback reference might process finalization calling would bad order fix wrote public sealed private static readonly new private next private prev private private next prev private prev prev prev next prev next prev next next prev public static root new public lock next prev prev prev next next next prev intending use like source root root callback root unlink source troubled seems open possibility memory leak without actually fixing case source limbo like source closed one callback rooted callback root never collected presumably let source collected without maybe ever appropriate try control order finalization giant warning sign