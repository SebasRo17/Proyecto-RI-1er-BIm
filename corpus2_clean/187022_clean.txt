played bit websockets started implement tiny chat last time something like thing thread computer single core started think implement today programming pattern come final conclusion implement chat functionality today technics higher level context server socket user user state undefined connected disconnected problem user maintenance user said hello num second connection opened disconnect user replied ping pong least num minute disconnect user connected num hour disconnect user assigned profile nickname detail num minute connect disconnect program specific flag kick user triggered disconnect current implementation like done olden day ie foreach socket user socket user run far many time lock block way much implemented today like example socket connects add add start per user thread run every x second run user per user queue get injected action like etc every x second also need per user thread constantly empty user queue maintenance thread run every x second last iterates bit like current implementation thread injects action user queue long kind action ran thread iterates user empty user queue something else even based queue