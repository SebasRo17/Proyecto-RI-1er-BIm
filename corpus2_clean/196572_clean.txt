sql query several thing multiple check check pas update without entering domain specific detail imaginary example user password updated user account removed locked threshold exceeded exists select people user userid userid begin exists select people user userid userid islocked num begin exists select people user userid userid num begin update people user set passwordhash hash userid userid select num success end else begin select num account exist longer end end else begin select num account locked end end else begin select num user cannot found end query used like var errorcode new query program connectionstring new userid id hash computehash readvalue code used database transformed exception soon possible switch errorcode case num throw new usernotfoundexception case num throw new case num throw new general programming code considered bad replaced conventional handling procedure including exception also bad use sql query yes rewrite query follow best practice given non functional requirement related load performance way make several consecutive query check update done single query