need label data arbitrarily nested ragged list stream unique label convenient label consecutive integer starting produce stream every time label given data set recursive function thread around current label parameter list conventionally every output say first element list convention essentially explicit simulation state monad haskell cumbersome ugly looking better solution unique come close fitting bill fresh kernel mma version mac consider following table unique great let try starting following documentation modulenumber table unique ooops surprise following first attempt produce internal enull bugcheck block modulenumber table unique mathematica detected internal error vmessage enull please report error soon possible support wolfram com giving many detail possible circumstance occurred mimic entire thing global state variable mimic unique thought first check insight advice