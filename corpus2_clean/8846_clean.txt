mapping earth magnetic field result left hand figure consists profile non linear trend reduction without threshold improve tried non linear trend reduction using example lm linearmodelfit data middle figure lm linearmodelfit data right hand figure respectively data defined data import table within scan environment occurrence artifact feel consider something like threshold reduction considered within threshold example data outside range affected calculation idea handle effectively idea first use lot separate profile several part ineffective time consuming would like handle profile separately combining r code used far setdirectory systemdialoginput directory listoffilenames readlist listing txt word scan data import table newfile stringreplace dat red dat wfile openwrite newfile formattype standardform clear lm clear clear neu clear aha start first first data mdim length data lm linearmodelfit data aha last take data ywert last aha xwert first aha neu ywert lm xwert mdim writestring newfile start write newfile neu mdim close wfile clear listoffilenames listing txt dat dat dat dat dat dat dat dat etc belisarius example show quality data outside pipeline want achieve mr wizard vsnr effect data enter image description