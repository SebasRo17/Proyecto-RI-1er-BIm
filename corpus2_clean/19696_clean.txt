got strange problem using ndsolve solve matrix value function x xy yx try solve compact form initialization code clear f f inverse f dd transpose ww transpose u matrixpower transpose f f r f inverse u simplify r transpose r x matrix variable directly specify form get problem solved x xy yx sol ndsolve tr dd identitymatrix dd transpose x xy yx however try define x xy yx single elegant problem clear func x arrayq tr dd identitymatrix dd x x transpose sol ndsolve func problem lay fact variable matrix treated inside ndsolve help fix