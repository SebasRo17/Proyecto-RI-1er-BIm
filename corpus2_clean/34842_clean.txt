overview large matrix need calculate element requires integration product two function complicated domain would like find set option nintegrate work well integration integration take second others take hour histogram timing integration clear fast one slow one histogram code nintegrate code timing following set plot show six integrands took less along visualization domain plot label show long took integrate example function take less integrate following set plot show six integrands took along visualization domain plot label show long took integrate example function take integrate see two group look much different however one take long time result integrated value close zero approx detail function forth plot set shown good one fast rg funa function x e x x x funb function x e x x x region function x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x x bad one slow rg funa function x e x x funb function x region function x x x x x x ugly integral nintegrate boole region x funa x funb x x rg rg rg rg method symbolicpiecewisesubdivision expandspecialpiecewise false method localadaptive maxrecursion minrecursion accuracygoal precisiongoal picked minrecursion make sure smaller feature domain found one example domain others involved smaller item used localadaptive seam get fewer complaint slow convergence use globleadaptive finally use expandspecialpiecewise false case get error exceeded number piecewise division dose appear connected number condition domain instead division done nintegrate tried many combination option nintegrate found one work gazillion matrix element realize possible code give test case give good idea run code report back