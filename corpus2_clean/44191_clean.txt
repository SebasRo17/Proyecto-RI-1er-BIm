time program spent single line code randomvariate multinomialdistribution nt tmp tmp vector np probability sum nt integer np component vector integer sum nt pseudo code loop get new np nt value set tmp randomvariate multinomialdistribution nt tmp stuff end loop example timing result real problem nt length tmp random example enough illustrate difficulty obvious way improve performance tmp nt timer timeused tmp may changed randomvariate multinomialdistribution nt tmp print time loop timeused timer sorry discussed