implemented code mathematica simulate scattering problem got really disappointed performance compared matlab since newbie mathematica would someone give clue clearall global integrand k p p rho l module x h x p l p l rho h hankelh norm x k h innerint k p p rho module r v x norm p p distancia entre o pontos v integrand k p p rho x r nintegrate v x r solvesystemcylinder segsstart segsend ei k eta module colocpts r x eivals colocpts segsstart segsend x mapthread innerint k x segsstart segsend r map colocpts eivals map ei k colocpts n linearsolve r eivals ei p k exp k first p k pi lambda lambda raio lambda eta nd num de divis e pt n raio co sin range nd pi nd pt lambda pt allpts join pt pt startpts take pt length pt endpts take pt length pt startpts take pt length pt endpts take pt length pt resolve j solvesystemcylinder join startpts startpts join endpts endpts ei k eta