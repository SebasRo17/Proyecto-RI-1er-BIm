trying solve numerical optimisation look something like joint x z pdf multinormaldistribution x z cond z conditionalmultinormaldistribution multinormaldistribution z zstar numberq z findroot cdf cond z z cap numberq numberq survivalfunction binormaldistribution zstar survivalfunction binormaldistribution zstar q numberq nintegrate x joint x z x z zstar nmaximize q q cap definition conditionalmultinormaldistribution follows post numerical optmization problem computationally expensive would like improve performance