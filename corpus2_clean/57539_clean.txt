following question side effecting array association mr wizard answer modernizing tweaking daniel lichtblau efficient queue ran little roadblock first came following api stripped brevity queue want fixed length lossy make new queue newq capacity push value back pushq aqueue avalue pop value front popq aqueue like queue human queue full pop value front losing purpose want pushq return queue receives fold chain follows fold pushq newq range came functional mojo highlighted clearall newq emptyqq fullqq pushq popq peekq bumpq newq cap integer cap storage constantarray null cap len cap cap ifront iback emptyqq q q len fullqq q q len q cap peekq q q storage q ifront setattributes bumpq holdfirst bumpq q index q index mod q index q cap setattributes pushq holdfirst pushq q item q storage q iback item bumpq q iback fullqq q bumpq q ifront else q len q functional mojo setattributes popq holdfirst popq q emptyqq q null popq q q len result q storage q ifront q storage q ifront null bumpq q ifront result pass bunch unit test q newq pushq q q storage null null null pushq q q storage null null pushq q q storage null popq q q storage null null popq q q storage null null null pushq q q storage null null pushq q q storage null popq q q storage null null pushq q pushq q pushq q pushq q pushq q q storage popq q try obvious generalization folding back started part assignment symbol fold pushq newq range evaluation set setps storage null null null null len cap ifront iback part assignment symbol evaluation set setps storage null null null null len cap ifront iback part assignment symbol evaluation general stop output set setps suppressed calculation storage null null null null len cap ifront iback ok need kind symbol set work couple attempt follows produce result bunch tracing printing see good way module q newq fold pushq q range evaluation set setps storage null null null null len cap ifront iback part assignment symbol module q newq fold q pushq q range evaluation set setps storage null null null null len cap ifront iback part assignment symbol edit question really elegance get meaningful useful side effect map scan follows module q newq pushq q range storage null null null len cap ifront iback storage null null len cap ifront iback storage null len cap ifront iback storage len cap ifront iback storage len cap ifront iback storage len cap ifront iback storage len cap ifront iback storage len cap ifront iback storage len cap ifront iback storage len cap ifront iback