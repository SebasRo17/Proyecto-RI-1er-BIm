given expression expr automated way find subexpression subexpr replacing subexpr temporary variable v minimizes leafcount expr subexpr v leafcount subexpr possible subexpr provide concrete example work cleaned small fragment expression someone asked unrelated question recently sqrt sqrt sqrt x co h co x tan x sec x x tan tan b sec x x tan co h co x tan tan b sqrt x co h co tan tan b co h co x tan co h co tan b tan tan b sqrt co h co tan tan b co h co x tan x sec x x tan tan b sec x x tan tan b co h co tan b tan tan b sqrt x co h co x tan x sec x x tan tan b sec x x tan co h co x tan tan b sqrt x co h co x tan x sec x x tan tan b sec x x tan co h co x tan tan b sqrt x co h co tan tan b co h co x tan co h co tan b tan tan b sqrt co h co tan tan b co h co x tan x sec x x tan tan b sec x x tan tan b co h co tan b tan tan b original problem leafcount almost fumbling manual substitution finally able make structure clear happened enable simplify reduce total leafcount second simple method automating would even better could recognize handle subexpr subexpr containing subexpr may much ask note trying actually see result mathematica subexpression sharing behind scene cannot see happened