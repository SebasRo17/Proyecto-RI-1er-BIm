want solve following equation self consistently h u e u u u e u u guess initial value diagonalize h get eigenvectors eigenfunction u e eigenvector h eigenvalue h define u u plug matrix diagonalize h get certain convergence e value get change within certain convergence range dmin course really simplified kind problem actual problem solve huge matrix really easy fortran wonder kind thing mathematica