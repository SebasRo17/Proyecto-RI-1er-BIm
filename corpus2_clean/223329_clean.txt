functional programming scala explains side effect impact breaking referential transparency side effect implies violation referential transparency read part sicp discusses using substitution model evaluate program roughly understand substitution model referential transparency rt de compose simplest part expression rt de compose expression always get result however quote state using side effect break substitution model example val x foo num bar num foo bar side effect executing either always result x side effect alter disrupts throw wrench substitution model feel comfortable explanation fully grok please correct fill hole respect side effect breaking rt discussing effect substitution model well