programming graph either mutable immutable state state get mutable state set allowed transition occurs one invokes compress optimizes storage graph deal fact method legal state others think two approach blunt way use state pattern invoke set graph mutable executes normally invoke set graph immutable thrown look ugly immutable still set alternatively make graph mutable graph sub second one set state change effected changing graph however also look ugly every implementation graph several make two type instead one edit using state pattern throwing exception neither solution especially preferable one involves writing least thanks advice