following code take like foreeeeever evaulate table table closen x max pricerange closen x min pricerange datestring extract date position closen closen x x length closen length pricerange basically looking price greater assigns smaller pricerange also extract date price closen always way realize might optimal fast way idea assumption optimize evaluation time small subset date closen pricerange whole data copy mathematica evaluate work closen date pricerange