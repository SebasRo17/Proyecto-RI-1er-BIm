need collect value row rectangular array arbitrary precision integer given target element value allowed distance position within row found target e g given target array ar target value allowed distance result result must order preserving e array read left right top bottom using neareles array ele dist posonly false r range dist dist dimension array posonly extract array sparsearray map integerdigits bitor bitshiftleft fromdigits r sparsearray bitxor unitize array ele nonzeropositions example called neareles ar get need actual data typically k x k k x k array size performs pretty well idea efficient perhaps less ungainly method