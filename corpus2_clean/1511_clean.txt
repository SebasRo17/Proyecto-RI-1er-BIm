integrate energy along path know energy beginning path energy determine energy change gain loss along energy x value energy x restricted since along path energy always equal certain value minimumenergy x minimum energy limit change abrut manner influence value downward path would done euler step manner would easy starting beginning path new step energy x max energy x step step energy x step minimumenergy x put restriction ndsolve tried artificially change energy x equation compensates difference minimumenergy x went well another problem energy x based value energy x equation real value energy x minimumenergy x tried figure implement stepmonitor came conclusion system slightly complex placed hope explanation good enough understanding problem following code run placed better understanding already implemented j suggestion eventlocator an energy flatten ndsolve energy outletchannelend minimumenergy flowrate bottomfunction energy x headloss flowrate height head flowrate energy x bottomfunction x energy x method eventlocator event energy x minimumenergy flowrate bottomfunction x eventaction energy x minimumenergy flowrate bottomfunction x result follows blue line minimum energy purple calculated one enter image description edit correctly detects event x asked print event action correct energy x