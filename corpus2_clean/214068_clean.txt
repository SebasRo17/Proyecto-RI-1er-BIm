planetary science researcher one project working n body simulation saturn ring goal particular study watch particle clump together self gravity measure aggregate mass clump versus mean velocity particle cell trying figure explain observation made cassini spacecraft summer large structure seen casting shadow nearly edge ring screenshot given look like particle num diameter simulation cell around num across n body cell simulation saturn ring particle shown tiny shaded sphere black background using already spit mean velocity every need figure way determine mass particle clump stray particle know every particle position mass size etc know easily say particle num num num num along num num num num make one strand human eye obvious algorithm need write would need user entered parameter possible objectivity would go particle position figure particle belong clump calculate mass would great could clump strand opposed everything cell think actually need separate thing thinking sort n num distance calculation calculate distance every particle say closest num particle within certain distance particle would considered part cluster seems pretty sloppy hoping c folk programmer might know elegant solution edited solution take sort nearest neighbor cluster approach quick n dirty n num implementation first take every particle calculate distance particle threshold cluster whether n particle within distance two parameter set priori unfortunately said response comment going get away sped sorting distance simply order n search increment counter particle within sped stuff factor num added stupid programmer tree know next nothing tree code divide simulation cell set number grid best result grid size num grid line cell one grid offset half x two offset num num x divide particle grid particle n distance calculated particle cell theoretically real tree get order n log n opposed n num speed got somewhere two num num particle sub set got increase speed num num particle cell got increase speed num second first num second second num second num num particle cell comparable speed long take simulation num forward reasonable point oh fully threaded take many processor throw