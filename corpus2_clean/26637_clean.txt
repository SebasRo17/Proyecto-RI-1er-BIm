algorithm need maintain set unordered list distinct element expression supporting two operation test expression membership set adding new expression set expression compared using sameq set hundred thousand element want work fast possible programming language would use hash table balanced tree implement set better data structure mathematica purpose plain list worth trying manually implement better structure