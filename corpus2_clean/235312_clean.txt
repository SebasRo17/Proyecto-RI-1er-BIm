historically probably would written script php something spreadsheet row perform calculation looking pure sql solution sql better option loop approach problem using pure sql approach overview list currently spreadsheet item want check trending let pretend spreadsheet contains three item num num num db table vendor inventory snapshot simplified example see fiddle create table inventory snapshot id vendor id item brand varchar num inventory version quantity insert inventory snapshot id vendor id item brand inventory version quantity value num num num num num num num num b num num num num num x num num num num num b num num num num num c num num num num num num num num num num c num num num num num num num num num num x num num notice vendor multiple row item given inventory version brand difference goal goal see trending vendor mean comparing list currently spreadsheet form item db retrieve item number starting qty sum qty min version number vendor item grouped vendor id inventory version total increase sum vendor version version increase qty total increase sum vendor version version increase qty ending qty sum qty max version number vendor item grouped vendor id inventory version another example see comment fiddle summary sound like sql server looping impractical better way approach