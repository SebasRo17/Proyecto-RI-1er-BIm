following simulation take second evaluation difficulty coding nest map compile function make efficient one help overview code numerical solution evolution density vehicle corridor l lane corridor split n section dx length section sink source coming ramp intern divided p segment network loaded ramp density time period simulated till network empty variable control inflow ramp corridor outflow factor b output simulation total density observed whole simulation also use parallelization code demand n k min k vf n capacity supply n k min n kj k w n capacity flo n ku kd min demand n ku supply n kd dx n p capacity b l rml vf kj w dt f module g k constantarray n k kr table table p n p k k rm j rampspill n kr ntwrktt tt plus plus kr tt tt fqin min demand l k supply l k fqout dem demand l k dem dem dem g min supply l k dem p g demand kr p qr p b fqin dx fqout min demand l k supply l k k k fqin fqout qr vf kr kr mr ir rml rm capacity rqin min mr ir flo kr ir kr ir rqout mr ir rml rm capacity rqout min mr ir p flo kr ir kr ir p kr ir kr ir rqin rqout vf ir p kr j n tt plus plus kr tt plus k k k ntwrktt tt j ntwrktt dt timing f edit please find profile output enter image description