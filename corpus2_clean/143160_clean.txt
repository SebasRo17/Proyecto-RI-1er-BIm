work parsec recently toy language wanted multi based fractional number expressible digging around parsec source bit found implementation floating point number parser copied make needed modification understand vaguely worked math fully yet think get gist come seems like pretty clever way turn string float ints algorithm something basic hole knowledge folk behind parsec devise first integer number integer parser integer number base digit base let n foldl x base x base num digit seq n n basic idea digit contains representing whole number part ie num foldl convert digit individually number add running total multiplied base mean end digit multiplied correct factor aggregate position fractional part even interesting fraction integer parser double fraction base digit base let base fromintegral base let f foldr x x fromintegral base base num digit seq f f general idea foldr using repeated division quite understand add first divide fraction multiply first add whole know work sorted anyway feel dumb working simple clever looking algorithm maybe imperative version using would familiar