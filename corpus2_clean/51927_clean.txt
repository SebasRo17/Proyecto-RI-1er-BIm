rewrite efficiently taking advantage flo dem nsup listable utilize parallel computation mapthread flo kr rest rk qsum kr table randomreal rk table randomreal qsum table randomreal flo compile p real p real p real min dem p nsup p p parallelization true runtimeattributes listable compilationoptions inlineexternaldefinitions true dem compile p real min p parallelization true runtimeattributes listable nsup compile p real p real min p p parallelization true runtimeattributes listable thinking form currently work flo kr rk qsum flor compile p real p real p real mapthread min demr nsupr p rest p p parallelization true runtimeattributes listable compilationoptions inlinecompiledfunctions true something avoids mapthread altogether suspect mapthread serial computation