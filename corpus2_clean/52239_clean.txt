set coupled differential equation represents equation motion particle cylindrical coordinate following hamiltonian h frac left p r frac p phi r p z right c sqrt frac r frac z c arbitrary constant hamilton equation dot q frac partial h partial p dot p frac partial h partial q get dot r frac p r dot phi frac p phi r dot z frac p z dot p r frac p phi r frac c r sqrt frac r frac z dot p phi dot p z frac c z sqrt frac r frac z hamiltoniancylindrical r phi z pr pphi pz c pr pphi r pz c sqrt r z cylindricaltrajectory r phi z pr pphi pz c step ndsolve r hamiltoniancylindrical r phi z pr pphi pz c pr phi hamiltoniancylindrical r phi z pr pphi pz c pphi z hamiltoniancylindrical r phi z pr pphi pz c pz pr hamiltoniancylindrical r phi z pr pphi pz c r pphi hamiltoniancylindrical r phi z pr pphi pz c phi pz hamiltoniancylindrical r phi z pr pphi pz c z r r phi phi z z pr pr pphi pphi pz pz r phi z pr pphi pz step workingprecision maxsteps infinity example run following plot evaluate r cylindricaltrajectory see r becomes negative possible cylindrical coordinate therefore wanted know solve set differential equation r update noticed something weird happening seen plot evaluate r cylindricaltrajectory imagesize large enter image description around r behaves unexpectedly however plot hiccup disappear another question convert cartesian cylindrical correct following transformation r sqrt x phi arctan left frac x right z z p r p x co phi p sin phi p phi x p p x p z p z one quite sure p r