trying something finding solution quantum mechanic problem n well well need find solution equation form b matrixpower c use findroot everything work great decent amount time actual code used something along line lowpropagator dist co dist sin dist sin dist co dist highpropagator dist cosh dist sinh dist sinh dist cosh dist root n start findroot matrixpower lowpropagator highpropagator n lowpropagator alpha start maxiterations manipulate root n n responsive even larger n try plot equation plotting function large complicated piecewise function alternating form f co alpha x b sin alpha x f cosh beta x b sinh beta x beta function alpha matrix lowpropagator highpropagator allow find function derivative point form piecewise function change use matrix inverse solve b plug giant piecewise lot computation going function function form getwavefunction rho b n module totalfunction x piecewise table eqlist x x wavepositions n eqlist n x totalfunction function trivial still run fast faster root finding even especially n high least n matrix multiplication however something like plotit n start module near f near root n start f getwavefunction near n plot f x x value function take forever draw graph black evaluation bar pop alt anything basically choose input value incorrectly time mathematica becomes completely unresponsive restart think mathematica still running calculating sometimes second return result curiosity left running overnight different value still frozen came back something right biggest issue two function fast input value certain input value combination two take forever question fix make function run decent speed make fail gracefully notebook crash relevant thing fails large n large dist taking matrix hyperbolic function nth power value get pretty huge understatement exactly happens value crash however root finding function seem crash value neither plotting function together cause problem figure evaluation might problem maybe root graph trying found many time inside plot function adding evaluate end whatever f near equal solve problem let know post full code relevant bit add line good amount spacing comment full code produce graphic like solution time independent schrodinger equation red line corresponds result findroot purpose findroot find solution exponentially decaying side graph red line exponentially decaying side dashed line corresponds start value findroot solution since diverges right side trying find solution time independent schrodinger equation single particle n well end chapter first course computational physic devries homework book ask solution general update full code able simplify code much significant extent simplify much point seems work calculating want calculate problem seems disappear think problem could evaluation though comment show end write f place f function result getwavefunction findroot passed argument print totalfunction similar number end since totalfunction exist scope guessing evaluation problem plot evaluates something really bunch time code keep mind running crash alpha frequency open region beta coefficient high energy region beta sqrt vm h alpha rho height leftmost wall width open region b width high energy region n number well function return pure function supposed wavefunction psi x depend time getwavefunction alpha beta rho b n module left eqleft eqright eqlist lowpropagator highpropagator lowinversecoefficients highinversecoefficients waverecursivefunction wavevalues wavepositions waveconstants totalfunction lowpropagator dist co alpha dist sin alpha dist alpha alpha sin alpha dist co alpha dist highpropagator dist cosh beta dist sinh beta dist beta beta sinh beta dist cosh beta dist wavefunction derivative represented aconst bconst psi psi solve aconst bconst take inverse matrix either corresponds low solution high solution lowinversecoefficients x co alpha x sin alpha x alpha sin alpha x co alpha x alpha highinversecoefficients x cosh beta x sinh beta x beta sinh beta x cosh beta x beta define leftmost point everything centered around left n b b wavevalues array giving value wavefunction derivative ie wavevalues psi left psi left wavevalues psi left capitaldelta x psi left capitaldelta x etc wavepositions position nth change height wavepositions start leftmost dip waveconstants hold value coefficient equation waveconstants n equal vector aconst bconst whether equation zero energy region high energy region depends whether n odd even respectively n odd constant correspond equation aconst co alpha x bconst sin alpha x n even constant correspond equation aconst cosh beta x bconst sinh beta x wavevalues wavepositions waveconstants table q n waverecursivefunction wavevalues rho rho beta wavepositions left waveconstants lowinversecoefficients left rho rho beta waverecursivefunction j fill previous value waverecursivefunction j mod j j left zero region right high energy region wavevalues j lowpropagator wavevalues j wavepositions j wavepositions j width high energy region waveconstants j highinversecoefficients wavevalues j j left high energy region right zero energy region wavevalues j highpropagator b wavevalues j wavepositions j wavepositions j b waveconstants j lowinversecoefficients wavepositions j wavevalues j waverecursivefunction n eqlist join evaluate highinversecoefficients rho rho beta cosh beta left sinh beta left table mod evaluate waveconstants cosh beta wavepositions sinh beta wavepositions evaluate waveconstants co alpha sin alpha n totalfunction x piecewise table eqlist x x wavepositions n eqlist n x totalfunction show plot totalfunction x x left left plotrange drawpotential b n plot totalfunction x x wavevalues wavepositions waveconstants eqlist totalfunction x column manipulate module f f alpha near left lowpropagator highpropagator c rationalize c rationalize rationalize rho rationalize rho left n f getwavefunction alpha sqrt c alpha rho n lowpropagator dist alpha co alpha dist sin alpha dist alpha alpha sin alpha dist co alpha dist highpropagator dist beta cosh beta dist sinh beta dist beta beta sinh beta dist cosh beta dist alpha near findroot sqrt c alpha v matrixpower lowpropagator alpha v highpropagator sqrt c alpha v n lowpropagator alpha v sqrt c alpha v alpha v alpha maxiterations evaluate alpha near alpha v alpha near ab im alpha near alpha near alpha near alpha near alpha near f evaluate getwavefunction alpha near sqrt c alpha near rho n f show plot f x x left left plotstyle dashed plot f x x left left plotstyle directive thick red exclusion none plotrange alpha sqrt c c rho n