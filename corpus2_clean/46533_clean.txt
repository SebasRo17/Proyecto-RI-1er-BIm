function believe correctly take multivariate taylor series expansion origin expression first argument variable second argument list different order third argument list method taking multivariate series expansion follows answer provided take series expansion highest order requested list unless highest order infinity case next highest used truncate series adding big variable requested order plus one requested order variable infinity expansion performed variable myseriesmwe exp x list list module po ow xw xdummy po position infinity length length po length return exp ow delete po xw x delete po exp thread xw xdummy xw series xdummy max ow normal xdummy sum xw ow length xw normal usually result expected test case provides result unintuitive think technically correct expression x z compare expansion origin power infty myseriesmwe x z x z myseriesmwe x z x z infinity output x z surprising taking third power z gave better approximation fact entire expression taking expansion z checked general case however think result correct myseriesmwe f x z x z expand myseriesmwe f x z x z infinity output f z f z f z f f z f z f x f x z f x z f x f x z f f z f z x f z last term first output x z expression x z believe expansion match definition multivariate taylor series origin throwing away proper higher order term first question function valid order less infinity believe answer yes never seen multivariate taylor series expansion truncated certain order second question function behavior correct requested order variable infinity third question better way write function variable wish expand somehow better preserved edit better way based suggestion john sidles idea penalize higher order term weighting replacement xdummy exponent depends unintuitively inversely requested order expansion variable modified function myseriesmwe exp x list list module po ow xw n xdummy xdummypower xdummylist testlist po position infinity length length po length return exp ow delete po xw x delete po n length xw xdummylist array xdummy max ow ow n testlist array ow n n xdummypower max table sum testlist j k max ow ow k k n j n exp table xw xdummylist xw n series xdummy xdummypower normal xdummy sum xw ow n normal ambiguity choosing order expansion xdummy chose conservative value including extra term truncated usual manner case obvious term missed expansion happen