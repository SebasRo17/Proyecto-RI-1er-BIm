note question also posted wolfram community problem simulate pressure volume second circuit follows enter image description set governing de volume plot solution ad ad ad cd cd cd v v rho beta p q ad cd sqrt rho p p q ad cd sqrt rho p p q ad cd sqrt rho p p q q q q q q ndsolve p beta q v p beta q v p p whenevent p p p p whenevent p p p p p p plot evaluate p p enter image description mathematica abort integration since encounter complex solution due p p point getting larger p make sense particularly since added whenevent allow p p greater p see code complex solution avoided adding ab however solution seem completely diverge enter image description question whenevent seem work p obtained credible solution using matlab constriction enter image description matlab code close b b clear basic data endtime steptime e p e cd cd cd ad ad ad v v rho beta e initialize p initial p initial initially old value simply set current value time p p initial p p initial initialize counter plot data saved pr number time step corresponding reportinterval reportcounter reportinterval counter reportinterval start time integration time endtime p p p p end p p p p end q cd ad sqrt rho p p q cd ad sqrt rho p p q cd ad sqrt rho p p flow orifice q q q q volume q q q q volume p dot beta q v p dot beta q v report counter reportinterval counter reportcounter reportcounter time plot reportcounter time p plot reportcounter p e p plot reportcounter p e end time integrate p p p dot steptime p p p dot steptime time time steptime counter counter end plot time plot p plot hold plot time plot p plot r grid matlab solution seems ok fit simulation result simulationx enter image description