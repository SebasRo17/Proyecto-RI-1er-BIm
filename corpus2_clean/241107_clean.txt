start cmd exe process redirect stdin pas script redirect stdout stderr read cmd isnullorempty bw write bw write byte n bw instance extension convert utf8 encoded byte use separate process work well however use shared library inside process contain valid localized character like russian character example convert character get cmd oem encoding work well separate process work shared library inside process