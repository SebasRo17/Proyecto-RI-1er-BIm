trying benchmark two case self referential many many described datamapper association case consist item may require many item case required ruby benchmark library source file created two item benchmarked require function benchmark x x report require item 1 require item item 2 num x report unrequire item 1 unrequire item item 2 end clear function datamapper add modify function like create component id item id quantity quantity component id item id destroy link component create component id item id quantity quantity link component component id item id destroy result range num num require case num num unrequire case made suspicious correctness test edit went ahead compared get primary key case finding first matching record case num num item create item end benchmark x x report get item item get num x report first item item first item end result different like num sec compared num expected suggests benchmarking work wonder whether benchmarked two type association correctly whether difference num num sec significant