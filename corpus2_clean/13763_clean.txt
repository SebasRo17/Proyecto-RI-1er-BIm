working logistic regression problem requires minimizing cost function j theta theta theta x find optimal value fitting parameter theta theta theta x known x matrix real number dimensional vector number sample data point approx training data set definition j j x length log h x log h x h x sigmoid x sigmoid z exp z try minimize j nminimize findminimum fail due singularity nminimize j x nminimize nnum function value indeterminate number findminimum j x findminimum nrnum function value indeterminate real number comparison matlab using fminunc suffers nan theta cost fminunc costfunction x optimset maxiter warning gradient must provided trust region algorithm using line search algorithm instead fminunc error using root line input root must contain nan inf snip however setting gradobj option make work theta cost fminunc costfunction x optimset gradobj maxiter local minimum possible fminunc stopped final change function value relative initial value less default value function tolerance stopping criterion detail theta theta cost cost way tweak mathematica solve notebook showing detail edit follow question indeterminate always unachievable infty way automatic regularization e adding regularization term lambda vec beta optimizing lambda fitting parameter vector vec beta binary non linear logistic regression using option setting logitmodelfit best fit found nminimize j min beta beta beta compared j min found matlab fminunc seems mathematica win right using logitmodelfit binary nonlinear logistic regression example found decision boundary hole way control complexity topology decision boundary thinking fitting fitting appendix complete code complete code data stored github intend keep long github allows appendix example data set per comment