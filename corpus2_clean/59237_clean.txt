especially tree structured data key value two side coin frequently interchange role ability aggregate value key upset balance improve workaround query defined operator form keygroupby f expr expr associationmap first groupby first f map value association example given data range associationmap foo foo foo foo foo foo desired output data keygroupby primeq false foo foo true foo foo foo fundamental constraint key transparent function accessing association association support data unique key example groupby nested associationmap drop last key value pair given key