need help correct design called push read source push buffer repeatedly left source also consumer thread read buffer soon new arrives option sort come buffer right instead pushing buffer push another sorting buffer start sorting thread read sort file push e sorted buffer bottleneck use merge sort file something avoid bad design push buffer consumer read think design