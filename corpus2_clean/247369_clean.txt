want speed following see attempt make understandable cython import numpy np numpy np np double dtype cpdef double std g v c std g num num newton const km num sol num v c num km extern math h double log double double sqrt double extern gsl gsl math h struct gsl double double x params params extern gsl gsl integration h struct gsl integration workspace gsl integration workspace gsl integration workspace alloc size n gsl integration workspace free gsl integration workspace w gsl integration const gsl f double double b double double size limit gsl integration workspace workspace double result double double callback double x params params eval x list def self cosmology none none self self self cosmology cosmology def call self double z z self self z def eval z num sqrt self cosmology z gsl integration workspace w gsl integration workspace alloc num gsl f f callback f params self double result num num double err dist gsl integration f num z num 1e num num w result err result gsl integration workspace free w dist self cosmology v c get proper unit ie put length self z dist dist cosmology public double omega omega l h w omega r g v c double length def init self omega num omega l num h num w num omega r num g std g self omega omega self omega l omega l self omega r omega r self h h self w w self g g self v c v c self self def copy self cosmology omega self omega omega l self omega l h self h w self w omega r self omega r g self g property def get self num self h km def self double z double inv inv num z self omega r inv num self omega inv num self omega l inv num num self w num self omega self omega l self omega r inv num self num property length def get self self v c self def rho self double z num self z num np pi self g def self double z double z2 none z2 none self z num z self z2 self z num z2 however one place raise find far substitution investigation reached point copy self supported cython read pickle possible provide substitution instance know produce copy inside update right way replace copy following piece def reduce self self self getstate def getstate self self omega self omega l self omega r self h self w self g self v c def setstate self self omega self omega l self omega r self h self w self g self v c second question property defined property cython also need set well last question point get compiled without message call instance cosmology zero wondering whether called instance cosmology vice versa caused problem pas info