using findroot solve complicated equation seems get correct answer even though get error nintegrate inside findroot number evaluatons one moreover possibility speeding process following example calculate function abar function bf cf recover bf abar cf done function bn bnverbose bn identical except evaluationmonitor n bmax n subscript b subscript b subscript b subscript b bmax subscript b subscript b n subscript c subscript c subscript c subscript c bf x sum subscript b sin pi x subscript b co pi x n cf x sum subscript c sin pi x subscript c co pi x n abar x nintegrate bf x cf abarb b numericq nintegrate b cf abarbj b numericq nintegrate b cf nintegrate b cf bn x b findroot abarb b abar x b bmax bmax jacobian abarbj b bnverbose x module e b e sol findroot abarb b abar x b bmax bmax jacobian abarbj b evaluationmonitor e print number evaluuations e n b sol bnverbose plot bn x bf x x plotstyle green red evaluation bn get several error form nintegrate inumr integrand b co pi sin pi sin pi sin pi evaluated non numerical value sampling point region boundary edit error screenshot error