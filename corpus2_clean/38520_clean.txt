code use two method computing matrixexp expected second snippet code faster first one fact bit slower imporve code nnx pp randomreal nnx nnx n q num absolutetime nn nn dimension pp sum num matrixpower pp n q re identitymatrix nn nest num absolutetime absolutetime nn nn dimension pp pp num pp qq matrixpower pp range q nn matrixpower pp q range n sum nn nn qq qq qq nn q nn n qq q re identitymatrix nn nest num absolutetime re re chop flatten union re matrixexp pp chop flatten union