defined following function r v rdet ab r v tdet rdet r v tdet rdet true arccos v tdet r rdet v tdet r r v v exp r rcloud r exp v v v v c v rbeam want weight defining function awfc numerically integrates product three function v r divide numerical integral two weighting function awfc rdet numericq v numericq nintegrate r v rdet r v v exp v r v nintegrate r v rdet r v v r v calculate awfc parameter rdet v awfctable paralleltable rdet awfc rdet v awfc rdet v awfc rdet v awfc rdet v rdet using value parameter tdet rcloud c v rdet rbeam kernel throw warning nintegrate slwcon numerical integration converging slowly suspect one following singularity value integration highly oscillatory integrand workingprecision small think hightly osciallating function see way fix problem use tableform ab awfctable get amplitude complex number awfctable problem output amplitude significantly larger especially larger v small rdet function calculating weighted mean maximum amplitude think weighted mean also maximum complex phase consistent expect different approach problem using matlab something wrong reasoning meaning result mathematica give actually correct fault lie implementation problem