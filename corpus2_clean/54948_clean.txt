question related one pivoting key nesting using leonid method starting point single key pivotup key query groupby key key keydrop key extend operation iteratively partially create hierarhical datasets tabular data interesting case include duplicate value pivoted duplicate key consider pivotup key list sequence flatten groupby key key keydrop key given data associationthread key key key b c dataset enter image description one way use pivotup data pivotup key key pivotup key key compact data pivotup key key key b key c key normal form key accessed either given pivotup alternative work data pivotup key key key enter image description desired output data pivotup key key key normal b c ideally partial pivot handle association structure