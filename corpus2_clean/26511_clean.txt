spent quite time trying figure fastest way get list list subexpressions position tried thing mapindexed seems ideal case expression function hold attribute present let evaluate freely held expression however found using mapindexed complicated unable get practical solution using furthermore tried thing extract position thing hinted comment answer positionfunction question mr wizard caused interested spent time feel quite fundamental question would like get feedback fair also quite glad answer considerably faster alternative found although took long time better alternative would even gladder know lastly may nice refer q later ever write good answer mr wizard question question fastest way get list list subexpressions position work held expression test expression let make big expression test let body n n head body n body n tree head body tree head body leafcount tree leafcount tree true