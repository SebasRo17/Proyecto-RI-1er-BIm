say matrix tmp size x shown small section illustration purpose consisting real number enter image description iteratively take every non zero real number element use input another loop argument limit calculate another set matrix value example taking second row first column value would like use calculate loop like r calculate p exp r p p place cumulated p result tmp output matrix corresponding location taken repeat next non zero element tmp row column value calculate p exp r p p result tmp location row column zero element found tmp simply mapped tmp location thanks