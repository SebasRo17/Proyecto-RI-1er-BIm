problem writing module spline smoothing actually trying two week listing splsmooth data knot lambda degree module knot nknots nbasis x dsq length data knot flatten table degree knot table degree nknots length knot nbasis nknots degree x table evaluate bsplinebasis degree knot n n n nbasis dsq difference x inverse transpose x x lambda transpose dsq dsq n transpose x data n return x trying place knot every point data numerical error arising inverse luc result inverse badly conditioned matrix may contain significant numerical error obviously corresponding result wrong see plot seems matrix inverted ill conditioned inverse transpose x x lambda transpose dsq dsq n transpose x data n come problem use equidistant knot let say point distance overcome problem sometimes algorithm work knot flatten table degree knot table degree time work knot flatten table degree knot table degree think kind problem bsplinebasis function q spot problem please anyone implemented simillar function past bsplinebasis function