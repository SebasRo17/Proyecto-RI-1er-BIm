working api rest service going producing consuming spent past day trying figure handle authentication nicely think finally come something coming based following fact application stack num client server net4 client part client profile num server expose using wcf rest num really want keep user password memory app num wanted use form token authentication credential verified server client get token back use throughout rest app allow thing timing user able move user seamlessly web desktop version etc figuring make call replay tamper resistant come following num client attempt authenticate generates key pair using num sends public part key pair wire along user password http course num server authenticates username password combination successful following num creates unique session token num generates dh key pair calculate shared secret public key provided client num make note session token shared secret user last action time used rolling expiration window database num return session token public dh key authentication success message num client take dh key response calculates shared secret store token secret memory point session token secret combination work like rest apis request timestamped sort hmac generated whenever client performs action server check token secret pair allows action valid expired update last action record session see obvious flaw probably engineered need learn point hmac prevents replay attack dh negotiation help prevent mitm attack think workable attack top head hmac dh hole anyone poke