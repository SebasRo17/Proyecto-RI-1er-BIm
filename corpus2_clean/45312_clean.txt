better way write gather list particle particlelist list particle coordinate coordlist want put particle dimensional ng x ng x ng array cubic box width coordinate take value xmin xmin x ng boxindx contains correct box particle given particle coordinate place appropriate particle proper box code easy read little slow know appendto supposed replacing reap sow result even slower time test problem typically take mac laptop thanks boxemup coordlist particlelist ng xmin module particlelistbybox particleindx boxindx particlelistbybox constantarray ng boxindx floor coordlist particleindx xmin ng ng appendto particlelistbybox boxindx particlelist particleindx particleindx length particlelist return particlelistbybox xyztst randomreal free randomsample range boxemup xyztst free free timing