way set aside code function triggered run evaluation function aborted user specifically function open log file write algorithm function many case finish aborted f module logstream openwrite logfile txt algorithm often finish close logstream way ensure within function close logstream get run even function get manually aborted loop mechanism achieve thing come across abortprotect seems like useful think applicable situation