elegant way obtain envelope oscillation function explained question modify code fit data obtained envelope parameter introduce parameter module used later fitting result module interpolation function let generate data randomreal b randomreal data table x co x exp b x x listplot data plotrange code generates something like data module produce envelope given oscillating function functionenvelope f b n module seed x point progress tempf union seed rescale range n n b point last last reap monitor quiet check progress x findmaximum ab f x x x x b sow x null x seed progressindicator progress length seed union point union point sametest ab first first replace max ab first ab first u u union tempf interpolation point point quiet join tempf point b tempf b union interpolation point used follows q f e ab co e ab co q g functionenvelope f x x plot f x g x x plotrange enter image description question modify module make function parameter q resulting interpolation function used fit data get optimal parameter q function f principle moved definition module going change thanks