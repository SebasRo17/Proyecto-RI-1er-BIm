matrix q dimension n time n structured q b ab cdots n b q augmented matrix built time matrix time matrix b need declaremathoperator rank rank rank q n get rank q n rowreduce matrix b calculation q matrix rank n want element one need continue idea get desired q matrix multiply q q text reduced dimension n time n get n time n matrix w rank w n want idea implement mathematica code suggestion would helpful cellgroupdata randominteger b randominteger rowreduce b rowreduce b n original matrix proc lnn j matrixpower j b j n flatten lnn j n j n table lnn j n j n r flatten qnn partition r n matrixrank qnn p r dimension qnn qn rowreduce qnn rowreduced matrix used lnn j matrixpower j b j n flatten lnn j n j n table lnn j n j n r flatten qn partition r n matrixrank qn p r dimension qn qn rowreduce qn print matrixform qnn matrixform qn print matrixform qn matrixform qn