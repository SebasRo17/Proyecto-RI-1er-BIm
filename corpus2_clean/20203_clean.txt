considering question formatting cell also one encountered issue confuses let code speak consider following simple cell expression contains comment line cellexpr cell boxdata rowbox rowbox indentingnewline rowbox rowbox b indentingnewline c input write notebook testnb notebookcreate notebookwrite testnb cellexpr look like following one would expect enter image description read cell expression back testnb selectionmove testnb notebook selectionmove testnb next cell notebookread testnb mathematica graphic note first rowbox structure rowbox item item ill posed since first argument rowbox must list obtained cell expression therefor ill posed seen cellprint ing enter image description noticed comment line part removed e g deleting cellexpr everything work fine example question second comment correctly obtained mathematica graphic question miss something bug system mathematica window bit