long time tried get head wrapped around visitor pattern somehow thing keep rather fuzzy currently impression useful apply operation object implement composite pattern least far php concerned accurate observation missing something process reimplementing functionality includes computing diff two entity entity contain various object different derivative hierarchy entity different object originally diff contained entity though caused quite clutter rather move dedicated service object visitor pattern sprung mind though see actually sanely apply would object need implement interface seems bad case visitor pattern indeed apply simply failing see would applied nicely