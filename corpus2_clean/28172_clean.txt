goal trace ray ground done rp geodesydata itrf semimajoraxis semiminoraxis sat point normalize sol findroot geoposition geopositionxyz sat f point itrf f idea starting point sat ray direction point ray intersects earth point geoposition give zero height far result gotten seem right plot simple case get following error message geopositionxyz invcoord f f f valid coordinate specification geoposition invcoord geopositionxyz f f f itrf valid coordinate specification part partw part geopositionxyz f f f itrf exist geopositionxyz invcoord valid coordinate specification better way use geoposition findroot