consider relational table derived survey data column represents responder row mdq survey question help intuition response data represented graphically color scaled disk underlying data matrix table integer bordered aforementioned string metadata first row column enter image description small submatrix given data id mdq mdq mdq define variable header id id mdq mdq mdq clean data response value subset question example mdq mdq must transformed example function note figure highlighted mdq mdq illustration would prefer use replacepart afaik pattern matching applied position index data value case metadata header part data alternative task mapat requires intermediate generation positional index barely readable code mapat numericq data flatten table first first position id length data mdq mdq way close semantic gap mapat replacepart achieve terse readable code