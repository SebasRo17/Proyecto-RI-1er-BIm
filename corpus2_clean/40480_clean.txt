trying extract connected bipartite graph bconn given incidence matrix b matrix representing bipartite graph incidence matrix b weighted unimportant want extract incidence matrix bconn corresponding connected bipartite sub graph incidence matrix may rectangular one transform incidence matrix b squared adjacency matrix diagonal block incidence matrix one transpose bi partite graph undirected thus symmetric standard basic graph theory would like find method directed undirected graph want transform incidence adjacency matrix turn graph use connectedcomponent subgraph transform graph object matrix method efficient think working matrix faster able find method undirected non bipartite graph probably even efficient way solve problem especially find way operate directly incidence matrix b code following sx dimension b sy dimension b join join table sx j sx b join b transpose table sy j sy isnode position total reverse aconn transpose delete transpose delete isnode isnode bconn sx sy sx sy course function operation point convinced algorithm looking something faster use directly b thanks suggestion solution