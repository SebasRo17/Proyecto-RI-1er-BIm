designing simple webservice want use hmac authentication service purpose question web service example com secret key shared user server k consumer id known user server necessarily secret message wish send server standard hmac implementation would involve using secret key k message create hash h running issue message quite long tends read file found difficult produce correct hash consistently across multiple operating system programming language hidden character make various file format course bad implementation client side num would like webservice easily accessible trouble different file format thinking alternative would allow use short num num random r rather message e g h hmac k r user pass random server server check hmac server side using random shared secret far see produce following issue message integrity ok message integrity important service user could use hash different message see num way around num combine random timestamp hash valid set period time num allow random used since client control random easier look collision point principle reason authentication implement rate limiting api service zero need message integrity big deal someone forge single request forge large number quickly know correct answer make sure message platform language hashing taking equation proposal acceptable 2nd best