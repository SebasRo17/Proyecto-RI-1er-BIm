coupling two concept bad approach right delegating session handling whether user desire logout config inc file writing auth started wondering whether auth taking care logic config inc regardless sure elegant way handling config inc also large chunk based reply found except find source ini set session sid session management session set cookie params num num num set sid cookie lifetime session start isset session logout session destroy destroy session session destroy session sanity check sid time num num num destroy session cookie header location docroot elseif isset session sid auth verify user authenticated isset session sid created session sid created time elseif time session sid created num num num session started num hour ago session regenerate id reset sid session sid created time update creation time isset session sid modified time session sid modified num num num last request num hour ago session destroy destroy session session destroy session sanity check sid time num num num destroy session cookie session sid modified time update last activity time stamp