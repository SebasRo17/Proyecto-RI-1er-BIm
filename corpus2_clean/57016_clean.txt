assume import data table source following format generalutilities field country region bu year date sale organization argentina latam america southafrica africa eame brazil latam america japan japan apac australia asean apac germany europe eame seedrandom list flatten table join organization year dateobject year month randominteger year month sale dataset associationthread field list enter image description would like summarize data year level working database sql command following format would allow create dataset still flat select sale country sale region sale bu sale year sum sale sale sumofsales sale group sale country sale region sale bu sale year enter image description using sale groupby key country groupby key region groupby key bu groupby key year total sale creates multilevel hierarchical data structure simple operate table type dataset enter image description way operate total mean median etc dataset grouping several key interest keeping dataset flat way done sql procedure