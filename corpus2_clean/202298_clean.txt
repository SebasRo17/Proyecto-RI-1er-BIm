looking node j avoiding nesting callback found async j someone show rewrite using async waterfall db mongodb instance db open err client client doc err col client collection doc err col var num num col insert c log insert done ok problem naive solution inner function async db open err client var mycollection doc client mycollection err col client collection mycollection err col var idx num idx num idx num col insert c idx log insert done ok three level nesting original seem like smell sure either home rolled async solution universally better would anyone prefer leaving nested function deep would nesting going using flow control