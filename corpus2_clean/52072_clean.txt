f kpr tn tv block differential equation simple control loop pid controller calculates response x integrates weighted area response function f kpr tn tv work ok optimization nminimize give error every method available st en clear x f f kpr tn tv block tab clear x x x ndsolve x x x kpr x tn x tv x x x x st en nintegrate ab x st en f f nminimize f kpr tn tv kpr tn tv method neldermead