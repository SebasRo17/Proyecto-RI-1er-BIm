develop algorithm find common substring given length n certain distance l front pattern p huge sequence e g want find common hexamers substring length occur front string pattern p ttaa distance l character front pattern ttaa step algorithm import sequence detect first position k occurrence pattern p extract site substring si front pattern position determine nmers substring length n site si select nmer substring common determine many site covered nmer delete list covered repeat list covered stop given number iteration result list nmers common one decending order coverage consider string variable sequence following code first determine position pattern p occurs sequence stringtake import pattern ttaa position stringposition sequence pattern ignorecase true want extract substring si length character front pattern p appears position sequence principle already solution problem appears quite slow large pattern match many position many si extracted substring table first stringtake sequence first stringtake sequence first first position runtime added test without left right parallelization paralleltable instead table enter image description enter image description however soon number found position pattern length sequence increase runtime approach explodes example run code whole sequence million character without left right parallelization paralleltable instead table enter image description enter image description faster way edit code proposed sk little bit faster still would need code run much longer sequence million character many hit million enter image description edit code proposed leonid shifrin seems hell fast piece code tested sequence million character got following result enter image description code proposed george achieves enter image description leonidshifrin comment way million char million hit really need lazy infrastructure holding extracted substring ram time possible large object interested kind solution yes indeed already thought later extracted si splitted overlapping substring length currently using partition list character idea dump save string si mx file move file file paralleltable cur fromcharactercode partition tocharactercode site nsize export filenamejoin path hexamers site stringjoin tostring padleft integerdigits mx cur length site