mathematica often expression involving matrix encounter dimension mismatch error like multiplying x matrix x matrix define new symbol dim passed algorithm fake parameter detect error dim dot dim x z matrixq z checkeq dimension z dim x dimension z method handle matrix operation failed table seems quite special fact failed pattern match table writing dim time dim x table z dim x incorrect syntax dim time table z dim x dim x expected result dim table sin j j dim dim multiplied every element table return dim sin dim sin dim sin dim sin dim sin dim sin dim full code clear dim checkeq function x x print tostring x tostring abort dim dimension dim x x dim matrixq dim true dim dot dim x z matrixq z checkeq dimension z dim x dimension z dim dot z dim x matrixq z checkeq dimension z x dim dimension z dim time z dim x matrixq z checkeq dimension z x dim x dim time dim x z matrixq z checkeq dimension z x dim x dim plus z dim x matrixq z checkeq dimension z x dim x dim dot dim x dim z w checkeq z dim x w dim time dim x dim z w checkeq x z checkeq w dim x dim plus dim x dim z w checkeq x z checkeq w dim x dim time x dim z numberq x dim z test return true matrixq dim dimension dim dim dim dim dim randomreal dim randomreal dim dim dim dim dim dim dim dim dim dim test raise error dim dim dim dim dim dim