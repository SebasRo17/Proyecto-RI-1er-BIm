believe may simplified idea anymore need flatten inside element array f ex input data z request period time z need generate time request number product sort give index number requst end append decision mapindexed prepend append sort flatten table partition append riffle randominteger z j j j j part answer know simplify decision