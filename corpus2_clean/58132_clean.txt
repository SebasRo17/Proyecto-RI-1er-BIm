question two dimensional non regular length list complex value working code however seems quite slow sure could improve mathematically trying achieve partial trace totalspace dimensional array list first two parameter two position parameter generally range second two variable length dependent position variable matrix position specified two position variable whose dimension depend position variable take two copy totalspace one complex conjugate finally need merge via summation two list together second fourth dimension equivalent value sum sum arrayflatten table table flatten table table totalspace x x c c conjugate totalspace x b x c b c c b lengthnode x b x b ming maxg c lengthnode x x ming maxg c lengthnode x x ming maxg looking way speed code mathematica function naturally merges list looked sow reap sure work really want sum reap ming maxg minimum maximum number indexing position normally ming however graph make sense negative indie number line lengthnode function take position index return number connected node node lengthnode x lengthnode x length connectednodes x ming min connectednodes maxg max connectednodes connectednodes list storing graph shape probably best explained example example make question clearer small concrete example trying achieve space consider four different position indexed nothing connected shown pictorially graph given graph mathematica encoded list node position connected data example shown connectednodes two quantum mechanical object graph ignoring fact normalised example total state space given totalspace table table table table c connectednodes x c connectednodes x x x mean dimensional object called totalspace indexed totalspace x x c c consider totalspace x x c c conjugate totalspace x b x c b c want output matrix every permutation x c one direction every permutation x b c b direction summed every combination x c code given sum arrayflatten table flatten table totalspace x x c c conjugate totalspace x b x c b c x b c b length connectednodes x b x c length connectednodes x x c length connectednodes x scale code larger graph say node implementation found take several second update upon suggestion updated code look bit cleaner sum arrayflatten table flatten table totalspace x x c c conjugate totalspace x b x c b c x b ming maxg c b lengthnode x b x ming maxg c lengthnode x x ming maxg c lengthnode x unfortunately detect real performace increase