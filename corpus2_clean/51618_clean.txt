want numerically integrate function berrycur kx ky definition berrycur given end question plot berrycur kx ky shown follows enter image description numerical integration nintegrate berrycur kx ky kx sqrt sqrt ky give error message nintegrate slwcon numerical integration converging slowly suspect one following singularity value integration highly oscillatory integrand workingprecision small correct answer zero since function abnormal place error message forgivable define another function berrycurtmp berrycursum kx numericq ky numericq berrycur kx ky berrycur kx ky plot berrycursum smooth shown enter image description numerical integration nintegrate berrycur kx ky kx sqrt sqrt ky still give error message nintegrate slwcon numerical integration converging slowly suspect one following singularity value integration highly oscillatory integrand workingprecision small could get correct answer zero speed numerical integration definition berrycur clear h h kx ky co ky sin kx sin kx co kx co ky co kx sin ky co kx co ky co kx sin ky co ky sin kx sin kx co ky sin kx sin kx co kx co ky co kx sin ky co kx co ky co kx sin ky co ky sin kx sin kx dim length h clear hpar hpar hpar kx ky h kx ky kx hpar kx ky h kx ky ky clear purifyeigs purifyeigs eigs transpose sort transpose eigs eigs berrycur kxkx numericq kyky numericq module eigs eigs purifyeigs eigensystem h kxkx kyky im sum conjugate eigs hpar kxkx kyky eigs j conjugate eigs j hpar kxkx kyky eigs conjugate eigs hpar kxkx kyky eigs j conjugate eigs j hpar kxkx kyky eigs eigs eigs j j deletecases range dim