working mstest automated test infrastructure testing tool merges set sql server database table basic structure test num define incoming dataset using anonymous type num apply using reconcile tool num read record table num compare result row column column example public list dynamic inspired massive etc new new externalid num propertyname hello agent test new externalid int64 num propertyname fred agent test fix problem cast issue dealing inferred anonymous object int32 corresponding column target table bigint hence record int64 result use assert areequal across column fails field assert areequal failed expected num system int32 actual num system int64 see cast second anonymous used fix issue primary aim test make sample slim easy read write possible prefer avoid visual noise cast thinking best way deal assertion seems like use dedicated assertion based guess real question aggressive converting type automatically