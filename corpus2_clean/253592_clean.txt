per ask question structure use asking hopefully implementation specific currently developing program represent chemical structure eventually allow manipulation reaction hashed two different system storing sure pick one option num nested matrix chemical less definite structure relative position item seems though would easier represent something like matrix assign definite coordinate atom bond unfortunately end overlap structure branch fair bit solve ended working solution used nested 5x5 matrix none none ch3 none none none none bond none none ch3 bond c bond ch3 none none bond none none none none ch3 none none c represents element carbon could represented couple different way particularly relevant bond represents bond ch3 represents another 5x5 matrix uppermost num num ch3 none none h none none none none bond none none h bond c bond h none none bond none none none none root none none bond reference uppermost bond first structure root undetermined way relating matrix connects next level complex structure one h would replaced another matrix additional ch3 advantage everything explicitly laid including structure good according zen chemical eventually represented graphically theoretically much easier make sure everything place disadvantage readable complex structure nested flat going require lot recursion walk option num dictionary another way could represent significantly less nesting better readability would using dictionary molecule would key dictionary would dictionary well atom bond requires quite bit less nesting would require little work eventually want display closing thought asking question indeed writing pretty set dictionary seems like cleaner easier storing require figuring really nasty recursive technique walk molecule however surprised missed something asking seems implementation specific please let know think change best make general