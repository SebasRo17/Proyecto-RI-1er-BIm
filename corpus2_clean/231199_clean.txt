wrote following piece delphi procedure update integer begin last update yesterday replace yesterday num begin end end realized contains small real race condition imagine first time called one millisecond midnight statement skipped timestamp updated another call one millisecond midnight timestamp wrong get correct practise think chance ever happening almost non existent typically called num minute b cpu time two call extremely small however bug curious would fix stumbled upon project