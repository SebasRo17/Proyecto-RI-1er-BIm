series call share similar quality basic layout public utility sqlhelper new utility stringbuilder query new stringbuilder num query append update environment newline insert select query append table environment newline utility query query scalar big fan stringbuilder case help readability break inline sql stored procedure option way much work convert higher priority linq ef option company sql num concrete plan upgrade