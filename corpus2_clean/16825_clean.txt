code draw tree functional style tree set module mz temp k p p b c e f pi mz co sin sin co co sin sin co temp set p store branch p store leaf k k k p length temp temp b temp c b c mz b e c b appendto p brown thickness k line b c appendto p c appendto p c appendto p c e temp p show graphic p rgbcolor line p ax plotrange tree mathematica graphic friend mine tried rewrite nest worked slower original code leaf nest apply transpose table rotationtransform pi rotationtransform pi graphic map rgbcolor line leaf absolutetiming mathematica graphic think nest slower loop rewrite make faster possible use fold nest similar functional construct