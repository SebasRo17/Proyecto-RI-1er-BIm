hope get spanked reposting related previous question discussed performance multinomial deviate slow version simpler binomial rather multinomial justification new question kluged together real solution problem someone might find useful hoping someone improve readability performance performance acceptable still bit slow compared c think might another factor speedup question anyone suggestion improve solution problem need bunch deviate parameter distribution different deviate simple way unacceptably slow nboxes p randomreal nboxes rt randominteger nboxes rp randominteger nboxes probs p rp mapthread randomvariate binomialdistribution rt probs timing timing result second laptop create one time faster generate binomial deviate parameter n p generate n uniform deviate count many p total number uniform deviate needed total rt generated small fraction second following code implement binomial deviate generator run total second deviate stored count anyone improve code performance readability etc ear first generate uniform deviate need box according rt count number deviate partition less box p value unitdeviates randomreal total rt timing nt constantarray nboxes table nt nt rt length rt timing count constantarray nboxes count nboxes count unitdeviates nt nboxes nt nboxes probs nboxes nboxes nboxes timing show mean variance two set deviate consistent n mean n mean count n variance n variance count