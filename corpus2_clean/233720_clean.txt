requirement need tool simulates hardware device communicates via rs232 tcp ip allow u test application communicate device current flow user load script parse script command user run script execute command script command simplified discussion connect rs232 connect tcp ip send sendcommand receive disconnect command implement icommand interface command runner simply executes sequence icommand implementation sequentially thus icommand must execute exposure pseudo execute context execute take context argument allows command implementation execute need instance sendcommand call context send etc problem need instantiate context used subsequent command handle elegantly solution num change icommand execute execute context work seems like smell command need context command except connection one context passed solution num create follows decorator pattern decorates introduces new exposure communicator icommand changed use wrapper execute context seems like cleaner solution question good design right track