wrote generate distribution particle bunch particle tempx randomvariate normaldistribution sqrt emitx randomvariate normaldistribution sqrt emitx tempy randomvariate normaldistribution sqrt emity randomvariate normaldistribution sqrt emity coords phi pi bucketheightp ab coords phi pi ab coords delta coords coords randomvariate normaldistribution phi blengthrad randomvariate normaldistribution maxdpp coordx xco sqrt betax tempx dx coords xpco alphax sqrt betax tempx sqrt betax tempx dpx coords coordy yco sqrt betay tempy ypco alphay sqrt betay tempy sqrt betay tempy particle flatten coordx coordy coords bunch append bunch particle think detail important call time randomvariate afraid quite inefficient would suggest major improvement