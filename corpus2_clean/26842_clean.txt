equation need solve k theta tan left frac w x p g k k w right frac r left left frac k right left frac p g k k right right variable p r g w constant mathematica fails solve constant place succeeds actual value substituted know possible unfortunately need general form computer program certain failing due tan way convince mathematica tan anything funky interval interested solve general case code as c c p g r u v vx u vy p g v rat simplify vx vy ksq vx vy wholeweak arctan rat r ksq