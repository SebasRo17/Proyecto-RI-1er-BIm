keep producing bit code like following stuff module curtarget getrowsforuserandtarget u curtarget validusers alltargets basically iterating target user using loop would look something like python re user validusers curtarget alltargets re append getrowsforuserandtarget u user curtarget seems like able succinctly map notation using something like getrowsforuserandtarget userthing targetthing validusers validtargets know keep mapped argument interfering reference one mean little hazy order iteration validusers would go first validtargets someone set straight would seem like common pattern abusing module solution