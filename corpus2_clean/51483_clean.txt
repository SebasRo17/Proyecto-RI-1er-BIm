write function called berrycur kx ky give end question want numerically integrate function kx ky sqrt plot berrycur shown follows enter image description checked value berrycur region positive numerical integration nintegrate berrycur kx ky kx ky sqrt give result zero absolutely wrong actually nintegrate result kx ky sqrt opposite nintegrate result kx ky sqrt strange wrong definition berrycur clear h h kx ky co sqrt ky sin kx sin kx e ky sqrt e kx sqrt ky e kx e ky sqrt e kx sqrt ky e kx co sqrt ky sin kx sin kx dim length h clear hpar hpar hpar kx ky h kx ky kx hpar kx ky h kx ky ky clear purifyeigs purifyeigs eigs transpose sort transpose eigs eigs clear berrycur berrycur kxkx numericq kyky numericq module eigs eigs purifyeigs eigensystem h kxkx kyky table im sum conjugate eigs hpar kxkx kyky eigs j conjugate eigs j hpar kxkx kyky eigs conjugate eigs hpar kxkx kyky eigs j conjugate eigs j hpar kxkx kyky eigs eigs eigs j j deletecases range dim dim