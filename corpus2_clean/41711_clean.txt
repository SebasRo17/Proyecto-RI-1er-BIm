fitting data pointwise function using nonlinearmodelfit produced fittedmodel fails calculate variance error consider toy example clear f data data f b f b f b fit nonlinearmodelfit data f b method nminimize take fit bestfitparameters give correct result b however try take fit estimatedvariance throw exception since value b substituted fit function guess found following obvious workaround clear f g h f g h f g h f g h fit nonlinearmodelfit data b f b g b h b method nminimize elegant best way obtain complete fittedmodel using nonlinearmodelfit pointwise function