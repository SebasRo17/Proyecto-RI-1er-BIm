want draw graphic part part made function generates coordinate according draw graphic problem mma operate expected figure simplified example graphic label tag circle goto tag text finished get output simply text finished want output graphic two circle radius center positioned together text finished figure way mma think give output accomplish desired output edit code really messy tip neatly write code mma would appreciated manipulate graphic calculating incident angle arcsin h r calculating x coordinate incident ray leaf prism p sqrt r h drawing incident ray red thick line h p h drawing prism blue opacity disk r pi checking whether reflection refraction h r n refraction calculating x coordinate refracted ray hit surface l r n sqrt r h n sqrt r h n drawing refracted ray red thick line p h l internal reflection calculating x coordinate internal reflection ray hit surface new h k label tag r co new tan r red thick line p new k k pi f r co h r sin k k line p new f h new h p f goto tag h height r appearance labeled n refraction appearance labeled r radius appearance labeled