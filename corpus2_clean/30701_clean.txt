matlab meshgrid came implementation mathematica x n table n j n j x z array list seems fast enough following example three time slower matlab mathematica b n table n j n j c b n sqrt compile position unitize fractionalpart c length absolutetiming matlab tic b meshgrid c sqrt b idx find c round c length idx toc recommend efficient method updated b transpose constantarray range c sqrt n b b sparsearray unitize fractionalpart c bitxor nonzeropositions length absolutetiming