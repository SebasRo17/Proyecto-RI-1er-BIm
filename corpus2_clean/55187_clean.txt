recenty encounter problem described table owns many box box sequence like etc addition every box value want make value box become average value box arounding example value box become average value box value box become average value box value box become average value box grid reverse partition range frame enter image description sequencevalue thread list range randominteger reverse partition sequencevalue grid frame enter image description trial extract sequence boundary table extractboundarysequence length width block bottomdata topdata leftdata rightdata cornerdata bottomdata range length topdata range width length width length leftdata range length width length length rightdata range length width length length cornerdata length width length width length list cornerdata bottomdata topdata leftdata rightdata extract sequence innerior table extractinteriorsequence length width block deletecases flatten table length flatten table range length length length width caculate value boundary table calculateboundaryvalue sequencevalue length width block corner bottom top left right cornersequence bottomsequence topsequence leftsequence rightsequence value value corner bottom top left right extractboundarysequence length width bottomsequence deletecases flatten table length bottom topsequence deletecases flatten table length top leftsequence deletecases flatten table length left rightsequence deletecases flatten table length right value mean flatten map part sequencevalue bottomsequence topsequence leftsequence rightsequence cornersequence deletecases flatten table length corner deletecases flatten table length corner deletecases flatten table length corner deletecases flatten table length corner value mean part sequencevalue cornersequence thread list flatten corner bottom top left right join value value caculate value innerior table calculateinteriorvalue sequencevalue length width block interiorsequence interiornumber value interiorsequence extractinteriorsequence length width interiornumber flatten table range length length length width value mean part sequencevalue interiorsequence thread list interiornumber value final sequence v alue newsequencevalue sequencevalue length width block newboundarydata newinteriordata newboundarydata calculateboundaryvalue sequencevalue length width newinteriordata calculateinteriorvalue sequencevalue length width sortby join newboundarydata newinteriordata first using function reverse partition newsequencevalue sequencevalue grid frame enter image description achieve result however think method little tedious question better algorithm method solve problem