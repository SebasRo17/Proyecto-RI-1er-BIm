rank matrix like v x w x x x x z x b v x b w x b x x b x b z x c v x c w x c x x c x c z x v x w x x x x z x want extract information based instance following key key w key b using map case flatten map case flatten p key key give desired unsorted result x w x x w x b x b w x reality matrix row always column key string key string x x list real value many repetitive lookup timing important question faster way thanks advance help