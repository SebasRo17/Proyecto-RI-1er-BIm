try use invarianterrorplot command generic system ode find example pre building equation mathematica package one need differentialequations ndsolveproblems need differentialequations ndsolveutilities system getndsolveproblem perturbedkepler var system dependentvariables h system invariant time step met symplecticpartitionedrungekutta differenceorder positionvariables subscript subscript sol ndsolve system time method met startingstepsize step maxsteps infinity parametricplot evaluate subscript subscript sol evaluate time invarianterrorplot h var sol plotstyle blue red question simple modify use invarianterrorplot equation thanks lot