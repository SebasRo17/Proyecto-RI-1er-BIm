interested following question possible check whether algorithm working properly however question general post like restrict attention spectral clustering using standard gaussian similarity function found section paper setting parameter sigma constructed following code note parameter sigma denoted epsilon spectralcluster data k module similarity weight walk lrw eigenvals eigenvecs kvecs similarity tr transpose data function point exp sqrt total point tr data weight diagonalmatrix total similarity walk inverse weight similarity lrw identitymatrix length similarity walk eigenvals eigenvecs eigensystem lrw kvecs take eigenvecs k clusteringcomponents kvecs k method kmeans distancefunction squaredeuclideandistance testing algorithm generate following data x randomvariate multinormaldistribution x randomvariate multinormaldistribution x randomvariate multinormaldistribution x randomvariate multinormaldistribution pt join x x x x listplot pt enter image description input data speccluster spectralcluster pt listplot pt speccluster output enter image description run algorithm different set data always generated multinormal distribution always return set increasing integer