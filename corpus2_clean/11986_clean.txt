need solve second order ode numerically ode depends two parameter b thing work fine small large solution oscillating rapidly mathematica take long time solve eventually run memory need integrate quite large range part problem actually need value interpolatingfunction produced end point way tell mathematica want last point store rest large interpolatingfunction memory e integrate far take point use ic next leg integrate next pt take ic integrate onwards etc strategy using ndsolve highly oscillatory solution definition rstar r r log r minprecision wp minprecision ac minprecision lambda l l l rinf rh nh ode eq omega l capitalphi r r r r capitalphi r omega r r lambda l r r capitalphi r without going detail initial condition horizonics l integerq omega numericq module capitalphi inrh capitalphi inrh clear b b b b b n b n simplify n n omega omega b n n omega b n l b n l b n n b n n b n omega b n n omega b n uintrunc r n sum b r n capitalphi inrh exp omega rstar rh uintrunc rh nh capitalphi inrh exp omega rstar r uintrunc r nh r r rh solve capitalphi inext omega omega l capitalphi inext omega omega l capitalphi ndsolve eq omega omega l capitalphi rh n horizonics l omega omega wp capitalphi rh n horizonics l omega omega wp capitalphi r rh rinf workingprecision wp accuracygoal ac maxsteps infinity method stiffnessswitching also look another solution property simple near infinity set ic particular solution seems really really slow cause memory crash definition r rstar r r log r minprecision wp minprecision ac minprecision lambda l l l rinf ninfphase set init condition infinitycs module n ninfphase c clear c veqexp coefficientlist series l r l r r r omega superscriptbox v prime multilinefunction none r r r superscriptbox v prime multilinefunction none r r r superscriptbox v prime prime multilinefunction none r r v r sum c r n v r sum c r n r infinity n r c c simplify solve veqexp c print n table c n infinityics integerq omega omega numericq module c c infinitycs l omega omega omega ninfphase vtrunc sum c r ninfphase init r exp omega omega rstar r vtrunc r rinf dinit r exp omega omega rstar r vtrunc r r rinf clear c init dinit solve capitalphi omega omega l capitalphi omega omega l capitalphi block maxextraprecision ndsolve eq omega omega l capitalphi rinf n infinityics l omega omega wp capitalphi rinf n infinityics l omega omega wp capitalphi r rinf r workingprecision wp accuracygoal ac maxsteps infinity