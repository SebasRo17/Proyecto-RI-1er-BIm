matrix size time row represent different group column represent different block block column block column block column block column want construct sparsearray size time matrix element less example element corresponding group block equal element corresponding group block greater value sparsearray equal input matrix use map boole generate matrix boole map output need specify condition final solution solution normal sparsearray j j total j j total j j total j j total j j total j j total j j total j j total j j total j j total j j total j j total dimension result wanted believe better way get result need