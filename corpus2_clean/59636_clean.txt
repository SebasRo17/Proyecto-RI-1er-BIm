question compiling function think related scoping order evaluation illustrate minimal example problem sorry lengthy question setup code mat expr x mb b x mc mb x exprindexed expr x atest btest ctest list expression expr represents vector first depends stand matrix mat time vector x constant known vector second depends b last b c want write expression compiled code evaluates particular want able define compiled function inside loop want really fully compile want evaluate much without knowing variable b b c respectively one attempt note omitting everywhere last argument compilationoptions inlineexternaldefinitions true compilationtarget c brevity compile evaluate real take b c mat mb mat b dc mat c exprindexed exprindexed real real mb real mat real important question necessary include type specification end plugging hand copying etc code work wrapping e g comp expr work mathematica give compiledfunction cfse compiled expression machine size integer however writing loopcode code comp loopcode work wonder although code work compile completely checked export test c comp reason assignment set global value e g da must talk mathematica fixed changing body compile module mat exprindexed work compiles cannot defined loop explicitly tried loopcomp compile evaluate real take b c module da mat exprindexed exprindexed real da real db real mat real comp loopcomp found way automate assignment mb mc e get module mat module mat mb mat b etc comp comp work least comp comp atest give error compiledfunction cfte compiled expression da rank tensor machine size real number output da da think issue scoping module compile know fix final issue even working version code explicitly copy pasting inserting time run everything computed e x computed compile every time code run note x defined expr defined happen another problem e x become plugged get matrix instead vector want evaluate much possible still getting vector output