trying take derivative numerical solution concerned way may problematic due numerical error think must better way experienced mathematica relevant function called gammafcn defined follows k c b tradeoff mig n x k c x b x mig f x n x e c x gstar x f x x f x sstar x nsolve k b gstar x x c f x c f x mig n x f x sstar x beta x mig n x estar x beta x istar x estar x lambda x beta x istar x star sigmai x estar x estar x mig n x sigmai lambda x sigmai p q z sum z n sigmai istar p mig n p e sigmai istar p mig n p e n q mig n q mig n n n n infinity p q z sum z n e e mig sstar q p n q p mig sstar q p n q p n n n n infinity p q z sum z n e e mig n p q mig n p q n n n n infinity part sigmai p q z nintegrate sigmai p q z infinity part p q z nintegrate p q z infinity part p q z nintegrate p q z infinity const sigmai re new sigmai istar re mig n re correct sigmai re new z const sigmai re new part sigmai re new z const sigmai re new part sigmai re new z part re new z gammafcn sigmai p q z estar p star sigmai p estar p correct sigmai p q z star sigmai p sigmai part p q z sigmai interested solution gammafcn sigmai p q z z z suppose solution given function gammafcnfixedpt sigmai p q particular want calculate first derivative gammafcnfixedpt respect p point p q fixed sigmai q following function small epsilon p q gammafcn gammafcnfixedptderiv sigmai q epsilon z findroot gammafcn sigmai q epsilon q z z z epsilon problem epsilon get sufficiently small result diverge decreasing epsilon function appear converging onto derivative presumably due precision error diverges pairing epsilon approximated derivative function sigmai q pairing epsilon go look though sequence approaching somewhere around thereafter diverges quickly assume due machine error positive even due error case know epsilon pick accurate derivative add precisiongoal integral code first block part p q z nintegrate p q z infinity precisiongoal part p q z nintegrate p q z infinity precisiongoal thing precisiongoal give set much higher take long time know derivative converging case approximately rather convergence occurring limit existing better way find derivative done thanks much