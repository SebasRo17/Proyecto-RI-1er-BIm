problem following consider list element better understanding following explanation would take example lista b c e f g h listb b c e f g h whatever used list want take element position previous illustrate lista program give position mean element c lista lista would take element lista sketched procedure step po lista po po c step listofposition flatten table j length lista j length lista step interpos position listofposition step po flatten listofposition interpos final step lista po po really say solution elegant solution knowing list deal irregular dimension listb think main difficulty edit firstly thank fast answer wrote code using block improve performance methode n karsten mr wizard index x position x depth x head false nexte x x sequence index x sequence flatten position index x thenexte x block step re step index x re x sequence step sequence flatten position step method n mr wizard index x position x depth x head false lookup x dispatch rule partition index x eof nextp x lookup x nexte x x sequence nextp x thenexte x block step step step re step index x step dispatch rule partition step eof step step re x sequence step method n mr wizard modification nexte expr po module f f po f x return x mapindexed mapindexed f expr length po nextp expr po module f f po f p return p mapindexed mapindexed f expr length po method n algohi index x case mapindexed f x f nextp x last index x position index x first case index x nexte x x sequence nextp x thenexte x block step step re step index x step last step position step first case step re x sequence step performance nexte thenexte thenexte thenexte