first define entry upvalues overloading expression head ftest ftest ftest aaa bbb r ftest aaa r bbb r try ftest r r r result expect ftest r however try r ftest r r r mathematica give result expect r derivative ftest r r derivative ftest r r edit result expect ftest r clarification suggested mr wizard thanks end edit understand fixed tried treeform unevaluated unevaluated r ftest r r r understand result img question overloading also tried treeform unevaluated unevaluated r ftest r r r understand mathematica meantime produce result img question overloading