solving pde partially elliptic need solve equation iteratively problem end code interaction manually order evaluate code second interaction know ndsolve accept new boundary condition please find comment body code could one help vm r di r de v f pr kf cf hi f kf f cf f c f f vm r tinf tme vm r v ym r r r vm f v r v ym r r r r r momento ndsolve r v r r u r r r f c u u r u r r r maxsteps considerando difusividade de momento mom r u r first momento hi kf r pr f f pr umed tmed x ttf x r tinf l tempo erro eps enf ndsolve f cf tf x r mom r tf x r x r r f r tf x r r r tf x r tme tinf exp x tinf tf r tme tf x r r r kf tf x r r r r exp x exp hi tmed x ttf x r tf x r x l r r tempo method methodoflines spatialdiscretization tensorproductgrid minpoints tff x r tf x r first enf clear med calculates average temperature med x numericq numericq nintegrate mom r tff x r r r r r umed evaluation med x x show med numeric position valid time med tempo created new function shall numerically equal med x tmed x numericq numericq evaluate med x everything ok code return ndsolve thing changed tmed tmed mistake enf ndsolve f cf tf x r mom r tf x r x r r f r tf x r r r tf x r tme tinf exp x tinf tf r tme tf x r r r kf tf x r r r r exp x hi tmed x ttf x r tf x r x l r r tempo method methodoflines spatialdiscretization tensorproductgrid minpoints tff x r tf x r first enf ndsolve ndnum encountered non numerical value derivative x p original message wolfram community