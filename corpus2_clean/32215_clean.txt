trying simple summation outer product wrote code straightforwardly could perhaps efficient way mat mat import datasets matrix matrix sdim ldim dimension mat dim sdim ldim dm constantarray dim dim kcounter kcounter k print k kcounter evaluation seems take forever spit current value k iterator keep track going b chop mat k mat k b dm mat k mat k b outer time mat sdim mat b sdim k sdim ldim b ldim added term check make sure necessary term zero taking lot longer still know lot mathematica function know way speed computation would fantastic