minor issue findminimum function using nintegrate inside function work perfectly well get warning message wondering maybe could enlightened correct usage two function together sake illustration provide full set function used simple example phi k h h piecewise h k h k k h k h h k h k k h k h psi k h h piecewise k h h k h k h k h k h h k h k h k h phipp k h h piecewise h k h k k h k h h k h k k h k h psipp k h h piecewise h k h h k k h k h h h k h k k h k h alpha k h phi k h phipp k h beta k h psi k h psipp k h pi n h n findminimum nintegrate h beta h h beta n h table alpha h n b table h beta h n b method conjugategradient get following warning message nintegrate inumr integrand piecewise pi piecewise pi b pi power piecewise power piecewise pi piecewise pi piecewise pi pi piecewise pi piecewise pi evaluated non numerical value sampling point region boundary ask findminimum take unexpectedly long time converge solution right one thought maybe using function correctly accelerate process