trying implement model predictive control scheme mathematica e g optimize input sequence predicting future output every time call cost function simulate system produce desired function value since cost function call ndsolve symbolic representation trying call cost symbolic variable produce result whenever try minimize cost function mathematica try evaluate cost function symbolically findminimum j b c x predy table u g table u ndsolve ndnum encountered non numerical value derivative replaceall rep ndsolve x x x x x u x x x x x x x x neither list replacement rule valid dispatch table cannot used replacing couple like telling mathematica know nonnumerical value force mathematica initialize minimization numerically without trying find gradient symbolically