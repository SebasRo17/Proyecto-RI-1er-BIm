trying get approximate derivative function chebyshev expansion start following random function f x x x x x look like graph random function try chebyshev approximation follows cgs clear array cgs pi integrate f x chebyshevt x sqrt x x cgs pi integrate f x chebyshevt x sqrt x x cf table chebyshevt x cgs x x x x x x x x x cf x sum cf cgs x x x x x x x x x plot cf x f x x give graph function chebyshev expansion think done everything correctly cannot see difference two graph derivative approximation use discussion numerical recipe section first take derivative f x df x f x x x x x clear da da da array da cgs da da da da da da use equation da cgs da cgs da da get da dcf table da chebyshevt x cgs x x x x dcf x sum dcf cgs x x x x plot dcf x df x x give plot wrong derivative clearly graph able figure problem constant term namely twice value test idea created test function test x x x x x plotted plot test x df x x get plot derivative show test f x anyone could help spot mistake would greatly appreciated