one basic problem working data like sale date case dont sale day fill take information average make plot see toy code example datelist need get answer missing date filled value zero date sale value get sql database created function fell could simplified getdaterange dtini dtfim nestwhilelist dateplus dtini dtfim filldategaps list module sortedorglist daterange listgaps sortedorglist sortby list daterange getdaterange first sortedorglist last sortedorglist listgaps complement daterange sortedorglist union list listgaps function calculation thing like datelistplot filldategaps datelist joined true datelistplot filled zero make simpler faster