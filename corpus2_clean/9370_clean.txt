working problem involves solving continuous time lyapunov equation r r top g symmetric positive definite matrix r real invertible sparse g diagonal singular solving equation various matrix using lyapunovsolve however situation get error message lyapunovsolve nuniq matrix equation unique solution always transform equation entry using coefficientarrays solve leastsquares however found incredibly slower lyapunovsolve notwithstanding yield solution whose error measured via norm r r top g quite satisfactory question following possible obtain lyapunovsolve solution albeit unique best possible solution least square sense example matrix reference hopefully copying notebook work thank advance g diagonalmatrix sparsearray sparsearray