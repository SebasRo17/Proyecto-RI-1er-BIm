want write function tensorreplace input take tensor polynomial r r r j r k r q j q k q q j q k replaces monomial function f idx using rule r rightarrow f r r j rightarrow f j etc leaving q another symbol untouched example input r r j r k r q j q k q q j q k shooting output f j k f q q j q q j q k also need allow possibility vector index squared repeated monomial given obvious r rightarrow f know even begin input could arbitrarily high order polynomial r many term