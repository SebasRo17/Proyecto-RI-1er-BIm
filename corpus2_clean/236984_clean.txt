two public method public fromstream inputstream inputstream public test send test fromstream fromstream stream way test result get test state according provided one public execute could test invoking execute would involve mock additional setup state exposed way testing one unit test feel right exposing inner state class testing accessing private field method also good thing mean design ok change way solve situation related tdd anti pattern