looking hamiltonian h begin pmatrix e omega e omega end pmatrix trying solve unitary operator u mathcal exp int dt h transformed u approx prod n n exp left ih ndt dt right calculate mathematica implemented similar code one found solving time dependent schroedinger equation changed little code read u h ti tf n module dt n tf ti n value value dot matrixexp h dt value ti tf dt value evaluated u exp exp however give long product matrix exponential matrixexp e e matrixexp e e really want write form h p e ih ft function p period pi omega way simply take take matrix log get h f get product form thus find value h f something wrong code missing step