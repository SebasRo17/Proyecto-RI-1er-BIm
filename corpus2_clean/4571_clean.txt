data given list ordered pair mixed scalar pair contain infinite bound goal convert data index used future computation data infinity infinity give unique value present data udata sort deleteduplicates flatten data less use dispatch create replacement rule based unique value dsptch dispatch thread udata range length udata finally replace value index expand scalar also pair result matrix index replace data dsptch integer note number unique value generally small compared length data case real number possible data shown simply give sense structural possibility question way create final matrix index much faster edit test potential solution scale recommend using following data fairly representative true life case inf infinity randomchoice range neginf infinity randomchoice range int sort randomchoice range num randomchoice range testdata randomsample join inf neginf int num