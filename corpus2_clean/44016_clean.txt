written interplanetary trajectory solver plotter plot path taken spacecraft earth mar mission run little trouble spacecraft actually reach mar hoping able get spacecraft orbit around mar upon arrival need find closest approach order apply correct delta v right time using wonder ndsolve whenevent function trajectory plot relies output interpolating function ndsolve interpolating function trying work far know closest approach occurs within day day trip put heliocentric x position mar spacecraft day separate table using following marsposition table x soln spacecraftposition table x soln calculated relative x position using following dxy sqrt marsposition spacecraftposition trying calculate minimum approach radius e combining x position magnitude bit code futile attempt trying dr min sqrt dxy dxy similar attempt unfortunately ended failure sample output look like dxy example first entry show x relative position trying combine two component radius combining x position pair radius using sqrt x first position pair given would get dr done manually entry practical hundred entry list radius position use min find close approach point spacecraft relative mar seen spacecraft get close mar inner semi circle earth orbit outer semi circle mar orbit line joining two spacecraft trajectory enter image description propagated see get close enough mar gravity affect trajectory enter image description look pretty close exactly close hoping find help would greatly appreciated