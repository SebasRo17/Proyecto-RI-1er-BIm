considering identity involving b c number index fixed cyclic property equal k possible element generated basis list permutation range basis basis b b union come output want convert expression like coefficient matrix linear algebra tried following code identity coeffmatrix coefficient identity basis transpose output efficiency matter small example however increase number index identity getting coeffmatrix becomes slow spends huge amount memory real case index size coeffmatrix approximately time come question coefficient always restricted reason would fact probably help boost performance could anyone give suggestion better efficiency