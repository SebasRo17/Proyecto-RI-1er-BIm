following code km rule mpc b rule myear c b mpc myear h b myear g b mpc kg myear rho crit pi g h r pi rho crit r e r scalefactor ndsolve sqrt r r r r sqrt g r c c e r r r r r r r r fullsimplify plot evaluate r r r particlehorizon r g nintegrate c sqrt e r evaluate r r scalefactor r r r g plot particlehorizon r g r g problem solved differential equation get r r solves without problem giving interpolating function trouble differentiating result respect r used particlehorizon function think might differential operator us dsolve ndsolve intrinsically b c f g lambda constant r boundary condition need solve differential equation r r e r set simplicity idea proceed also rule change r r trying see work thanks advance