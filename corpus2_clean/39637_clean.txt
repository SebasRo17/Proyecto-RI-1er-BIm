want use bluechip pci adc acquisition card mathematica via dynamic link library bcdll dll used access function pci data acquisition card problem function bctgetboardid open board providing board type integer card board number integer card considering vb net programming language bctgetboardid function defined public declare function bctgetboardid lib bcdll dll byref pboardid bct board id byval ndevtype short byval nboard short integer variable pboardid bct board id type vb net type defined structlayout layoutkind sequential public structure bct board id dim handle integer dim serialno integer marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany dim devname byte marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany dim clock name byte marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany dim clock name byte marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany dim clock name byte dim hclock bct handle dim hclock bct handle dim hclock bct handle dim index integer dim devicetype integer end structure according bluechip vb file allows access dll library function vb net program case bct board id structure described vb net cannot declare dimensioned array within structure instead use marshalas attribute class handle array data obtain data contained pboardid variable using help offered multiple null terminated string handled dll function result used mathematica program follows need netlink path c window system bcdll dll bcdll dll path codgbi definedllfunction bctgetboardid path short intptr system int system byte maxbuflen loadnettype system runtime interopservices marshal buf marshal allochglobal maxbuflen codergbi codgbi buf managedarray netnew system byte maxbuflen marshal copy buf managedarray maxbuflen byte netobjecttoexpression managedarray fromcharactercode deletecases splitby byte obtained following confuse answer value codergbi indicate correct function syntax pciadc b b da f ca pciadc pciadc pciadc realtek pcie gbe family controller packet scheduler miniport b r r clear mastered subtlety programming net framework please help extract mathematica correct form data contained structure buf function codgbi buf first many thanks alexey popkov sugestion calling dll function return structure many many thanks todd gayley superb example presented mathgroups thread please ignore last line first code split byte structure stupid trial inspired multiple null terminated string handled dll function result bad adapted understand solve problem rebuilt corrected small error sign bad placed due publisher site didactic example offered todd gayley second problem deal nested structure bct board id structure presented use bct handle structure last use overlapped structure follows structure overlapped dim internal integer dim internalhigh integer dim offset integer dim offsethigh integer dim hevent integer end structure public structure bct handle dim handle integer dim overlap overlapped dim devicetype integer dim boardtype integer dim nport short dim lasterror integer dim nexttime integer end structure analyzing material nested structure pinvoke net others suggested following definedllfunction path c window system bcdll dll bctboardid definedllfunction public struct overlapped public system int internal public system int internalhigh public system int offset public system int offsethigh public system int hevent public struct bct handle public system int handle public overlapped overlap public system int devicetype public system int boardtype public system byte nport public system int lasterror public system int nexttime structlayout layoutkind sequential public struct bct board id public system int handle public system int serialno marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany public system byte devname marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany public system byte clock name marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany public system byte clock name marshalas unmanagedtype byvalarray sizeconst arraysubtype unmanagedtype asany public system byte clock name public bct handle hclock public bct handle hclock public bct handle hclock public system int index public system int devicetype return marshalas unmanagedtype byte dllimport path callingconvention callingconvention stdcall charset charset auto setlasterror true public static extern short bctgetboardid bct board id pboardid system int ndevtype system int nboard unfortunately received message definedllfunction compileerr compiler reported error dll function declaration invalid token struct class struct interface member declaration please help identify error