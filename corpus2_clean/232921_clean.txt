let say num database record need process following way num start num pull num record database processed flag set num call external web service custom num record num update num record database set processed num goto num happen scenario num num occur pulling record database fine next round try get num occur calling external web service also fine next round try send num record num occur calling database processed record update optimistic never happen keep mind already sent num record via web service must send cost one option call database update run successfully num question would handle situation update illustration db database w webservice trans db open transaction trans query two record update processed w response w send text message w response success trans commit would fails else trans rollback