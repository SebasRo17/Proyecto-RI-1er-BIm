write filtering system may apply preprocessed ruleset trigger action defined ruleset continuing evaluation ruleset num rule condition match image level num match image level num match image level num action apply ruleset ruleset num rule rule rule ruleset ruleset num ruleset good example feel alike sendmail configs apache configs ruleset multiple table join accept drop etc bother every current design think keeping state node able jump sub rulesets easily tracking circular reference keeping vast set possible condition runtime speed parsing hashing may take time packet must passed dataset fast possible read think sure parser nice enough work large set mess speed flexibility much mention target language c however would like implement similar system perl later reading still see good solution switching rulesets keeping boolean logic within rule