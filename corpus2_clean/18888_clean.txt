curious decompose work decided use trace option traceinternal true nextprime work well appendto contextpath numbertheory nextprimedump trace nextprime traceinternal true nextprime block re re integernextprime rulecondition re integerq re re integernextprime rulecondition re integerq re integernextprime block re re mod primeq re re rulecondition re integerq re re mod primeq re re rulecondition re integerq re mod re primeq re re re primeq true true false null re integerq true rulecondition re true re re re integerq true rulecondition re true re see code get idea nextprime work decompose get something weird p expand x x x x trace decompose p x traceinternal true decompose x x x x x bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand bitand x x x x way tell bitwise ands coming traceinternal supposed show working execution