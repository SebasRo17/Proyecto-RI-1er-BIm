using databaselink query m sql server sqlexecute work totaly fine ex sqlexecute conn declare dt date select ttable date dt however problem start try use table variable try return ex sqlexecute conn declare dt date declare tab table var int date date insert tab select ttable date dt select tab return number row table way solve seems mathematica return result insert statement final result