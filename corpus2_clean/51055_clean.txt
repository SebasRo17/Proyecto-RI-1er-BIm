consider incidence matrix bipartite graph aij node group node j group connected symmetric assume disconnected weakly connected e least one degree one degree zero trying write function input matrix output new matrix number node edge strongly connected degree different zero want achieve result rewiring minimum number edge network function developed following one biprangraphconn matrix module row col l po row xy row xy row row rulerow po col xy col xy col col rulecol sign matrix row col dimension matrix l total partition nest randomsample flatten matrix dimension matrix po row position total x x row case gatherby position x x first x length x po row position total x x po col position total x x col case gatherby position x x last x length x length po row length po col length po row length row length po row xy row join po row randomchoice partition range col length po row xy row flatten randomsample randomsample row length po row rulerow flatten table xy row extract xy row xy row length xy row replacepart rulerow col case gatherby position x x last x length x length po col length col length po col xy col join po col randomchoice partition range row length po col xy col flatten randomsample randomsample col length po col rulecol flatten table xy col extract xy col xy col length xy col replacepart rulecol general work well find case fails give matrix still weakly connected appreciate help understand fails better way working case working case usually large matrix working case time smaller size